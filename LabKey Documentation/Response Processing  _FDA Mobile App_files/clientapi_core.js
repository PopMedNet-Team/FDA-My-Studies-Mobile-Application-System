var console=console||{warn:function(){}};LABKEY.Utils=new function(){var c="0123456789abcdefghijklmnopqrstuvwxyz".split("");var b=100;var k="j-M-y g:i a|j-M-Y g:i a|j-M-y G:i|j-M-Y G:i|j-M-y|j-M-Y|Y-n-d H:i:s|Y-n-d|Y/n/d H:i:s|Y/n/d|j M Y G:i:s O|j M Y H:i:s|c";var e="n/j/y g:i:s a|n/j/Y g:i:s a|n/j/y G:i:s|n/j/Y G:i:s|n-j-y g:i:s a|n-j-Y g:i:s a|n-j-y G:i:s|n-j-Y G:i:s|n/j/y g:i a|n/j/Y g:i a|n/j/y G:i|n/j/Y G:i|n-j-y g:i a|n-j-Y g:i a|n-j-y G:i|n-j-Y G:i|n/j/y|n/j/Y|n-j-y|n-j-Y|"+k;var g="j/n/y g:i:s a|j/n/Y g:i:s a|j/n/y G:i:s|j/n/Y G:i:s|j-n-y g:i:s a|j-n-Y g:i:s a|j-n-y G:i:s|j-n-Y G:i:s|j/n/y g:i a|j/n/Y g:i a|j/n/y G:i|j/n/Y G:i|j-n-y g:i a|j-n-Y g:i a|j-n-y G:i|j-n-Y G:i|j/n/y|j/n/Y|j-n-y|j-n-Y|j-M-y|j-M-Y|"+k;function l(m){return typeof m=="object"&&Object.prototype.toString.call(m)==="[object Object]"}function h(p,n){if(n==0||!l(p)){return p}var q={};for(var m in p){q[m]=h(p[m],n-1)}return q}function j(q,p,m,o){for(var n in p){if(p.hasOwnProperty(n)){if(l(q[n])&&l(p[n])){j(q[n],p[n],m,o-1)}else{if(undefined===q[n]||m){q[n]=h(p[n],o-1)}}}}}var i=function(o,m){if(null==o){return null}var n=o.nextSibling;while(n!=null&&!n.tagName){n=n.nextSibling}if(n==null){return null}if(LABKEY.experimental.useExperimentalCoreUI&&m){if(n.tagName!=m){return null}}else{if(n.tagName!="TR"){return null}}return n};var a=function(q,o,n){var r=false;var m=q.href;if(LABKEY.experimental.useExperimentalCoreUI&&n){while(q.tagName!=n){q=q.parentNode}}else{while(q.tagName!="TR"){q=q.parentNode}}var p=i(q,n);if(null!=p&&p.style.display!="none"){r=true}while(p!=null){if(p.className.indexOf("labkey-header")!=-1){break}if(p.style.display!="none"){p.style.display="none"}else{p.style.display=""}p=i(p,n)}if(null!=m&&o){f(m,r)}return false};var f=function(m,n){if(m){if(n){m+="&collapse=true"}LABKEY.Ajax.request({url:m})}};var d=function(p,o,m){a(p,o,m);var n=0;while(typeof(p.childNodes[n].src)=="undefined"){n++}if(p.childNodes[n].src.search("plus.gif")>=0){p.childNodes[n].src=p.childNodes[n].src.replace("plus.gif","minus.gif")}else{p.childNodes[n].src=p.childNodes[n].src.replace("minus.gif","plus.gif")}return false};return{encodeHtml:function(m){return String(m).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;")},isArray:function(m){return Object.prototype.toString.call(m)==="[object Array]"},isDate:function(m){return Object.prototype.toString.call(m)==="[object Date]"},isDefined:function(m){return typeof m!=="undefined"},isFunction:function(m){var n={};return m!==null&&m!==undefined&&n.toString.call(m)==="[object Function]"},isObject:l,getDateAltFormats:function(){return LABKEY.useMDYDateParsing?e:g},displayAjaxErrorResponse:function(){console.warn("displayAjaxErrorResponse: This is just a stub implementation, request the dom version of the client API : clientapi_dom.lib.xml to get the concrete implementation")},getMsgFromError:function(m,r,p){p=p||{};var o;var q=p.msgPrefix||"An error occurred trying to load:\n";if(m&&m.responseText&&m.getResponseHeader("Content-Type")&&m.getResponseHeader("Content-Type").indexOf("application/json")>=0){var n=LABKEY.Utils.decode(m.responseText);if(n&&n.exception){o=q+n.exception;if(p.showExceptionClass){o+="\n("+(n.exceptionClass?n.exceptionClass:"Exception class unknown")+")"}}}if(!o){o=q+"Status: "+m.statusText+" ("+m.status+")"}if(r&&r.message){o+="\n"+r.name+": "+r.message}return o},resizeToViewport:function(){console.warn("LABKEY.Utils.resizeToViewport has been migrated. See JavaScript API documentation for details.")},getFileIconUrl:function(o){var m=o.lastIndexOf(".");var n=(m>=0)?o.substring(m+1):"_generic";return LABKEY.ActionURL.buildURL("core","getAttachmentIcon","",{extension:n})},getCallbackWrapper:function(o,n,m){return function(p,r){var s=p.responseJSON;if(!s){if(p&&p.getResponseHeader&&p.getResponseHeader("Content-Type")&&p.getResponseHeader("Content-Type").indexOf("application/json")>=0){try{s=LABKEY.Utils.decode(p.responseText)}catch(q){}}p.responseJSON=s}if(!s&&m){s={}}if(s&&!s.exception&&m){s.exception=(p&&p.statusText?p.statusText:"Communication failure.")}if(o){o.call(n||this,s,p,r)}else{if(m&&p.status!=0){LABKEY.Utils.alert("Error",s.exception)}}}},applyTranslated:function(q,p,n,o,r){if(undefined===q){q={}}if(undefined===o){o=true}if(undefined==r&&o){r=true}var m;for(var s in p){if(s=="constructor"||LABKEY.Utils.isFunction(s)){continue}m=n[s];if(m){q[n[s]]=p[s]}else{if(undefined===m&&o&&(r||!LABKEY.Utils.isFunction(p[s]))){q[s]=p[s]}}}},setCookie:function(p,q,o,s){var m;if(s){var n=new Date();n.setTime(n.getTime()+(s*24*60*60*1000));m="; expires="+n.toGMTString()}else{m=""}var r="/";if(o){r=location.pathname.substring(0,location.pathname.lastIndexOf("/"))}document.cookie=p+"="+q+m+"; path="+r},getCookie:function(n,p){var q=n+"=";var m=document.cookie.split(";");for(var o=0;o<m.length;o++){var r=m[o];while(r.charAt(0)==" "){r=r.substring(1,r.length)}if(r.indexOf(q)==0){return r.substring(q.length,r.length)}}return p},getSessionID:function(){return LABKEY.Utils.getCookie("JSESSIONID","")},deleteCookie:function(n,m){LABKEY.Utils.setCookie(n,"",m,-1)},requiresScript:function(m,p,n,o){LABKEY.requiresScript.apply(this,arguments)},requiresCSS:function(m){LABKEY.requiresCss(m)},endsWith:function(n,m){if(!n||!m){return false}if(n.length<m.length){return false}return n.substring(n.length-m.length)==m},pluralBasic:function(n,m){return LABKEY.Utils.pluralize(n,m,m+"s")},pluralize:function(o,n,m){return o.toLocaleString()+" "+(1==o?n:m)},onTrue:function(m){m.maxTests=m.maxTests||1000;try{if(m.testCallback.apply(m.scope||this,m.testArguments||[])){LABKEY.Utils.getOnSuccess(m).apply(m.scope||this,m.successArguments||[])}else{if(m.maxTests<=0){throw"Maximum number of tests reached!"}else{--m.maxTests;LABKEY.Utils.onTrue.defer(10,this,[m])}}}catch(n){if(LABKEY.Utils.getOnFailure(m)){LABKEY.Utils.getOnFailure(m).apply(m.scope||this,[n,m.errorArguments])}}},ensureBoxVisible:function(){console.warn("LABKEY.Utils.ensureBoxVisible has been migrated to the appropriate Ext scope. Consider LABKEY.ext.Utils.ensureBoxVisible or LABKEY.ext4.Util.ensureBoxVisible")},id:function(m){return(m||"lk-gen")+(++b)},generateUUID:function(){if(LABKEY&&LABKEY.uuids&&LABKEY.uuids.length>0){return LABKEY.uuids.pop()}var q=c,o=new Array(36),n=0,p;for(var m=0;m<36;m++){if(m==8||m==13||m==18||m==23){o[m]="-"}else{if(m==14){o[m]="4"}else{if(n<=2){n=33554432+(Math.random()*16777216)|0}p=n&15;n=n>>4;o[m]=q[(m==19)?(p&3)|8:p]}}}return o.join("")},textLink:function(n){if(n.href===undefined&&!n.onClick===undefined){throw"href AND/OR onClick required in call to LABKEY.Utils.textLink()"}var m=" ";if(n){for(var o in n){if(n.hasOwnProperty(o)){if(o.toString()!="text"&&o.toString()!="class"){m+=o.toString()+'="'+n[o]+'" '}}}return'<a class="labkey-text-link"'+m+">"+(n.text!=null?n.text:"")+"</a>"}throw"Config object not found for textLink."},getOnFailure:function(m){return m.failure||m.errorCallback||m.failureCallback},getOnSuccess:function(m){return m.success||m.successCallback},merge:function(n,m,r){var q=n;for(var p=1;p<arguments.length;p++){j(q,arguments[p],true,50)}return q},mergeIf:function(n,m,r){var q=arguments[0];for(var p=1;p<arguments.length;p++){j(q,arguments[p],false,50)}return q},onError:function(m){console.warn("onError: This is just a stub implementation, request the dom version of the client API : clientapi_dom.lib.xml to get the concrete implementation")},isEmptyObj:function(m){for(var n in m){return false}return true},roundNumber:function(m,n){return Math.round(m*Math.pow(10,n))/Math.pow(10,n)},padString:function(n,p,q){if(typeof n!="string"){n=n.toString()}var m="";if(p>n.length){for(var o=0;o<(p-n.length);o++){m+=q}}return m+n},caseInsensitiveEquals:function(n,m){return String(n).toLowerCase()==String(m).toLowerCase()},isBoolean:function(n){var m=n.toString().toUpperCase();if(m=="TRUE"||n=="1"||m=="Y"||m=="YES"||m=="ON"||m=="T"||m=="FALSE"||n=="0"||m=="N"||m=="NO"||m=="OFF"||m=="F"){return true}},isString:function(m){return typeof m==="string"},onReady:function(m){console.warn("onReady: This is just a stub implementation, request the dom version of the client API : clientapi_dom.lib.xml to get the concrete implementation");if(typeof m==="function"){m()}},decode:function(m){return JSON.parse(m+"")},encode:function(m){return JSON.stringify(m)},apply:function(q,p){var n=["hasOwnProperty","valueOf","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","constructor"];if(q&&p&&typeof p==="object"){var r,o,m;for(r in p){q[r]=p[r]}if(n){for(o=n.length;o--;){m=n[o];if(p.hasOwnProperty(m)){q[m]=p[m]}}}}return q},alert:function(n,m){console.warn("alert: This is just a stub implementation, request the dom version of the client API : clientapi_dom.lib.xml to get the concrete implementation");console.warn(n+":",m)},escapeRe:function(m){return m.replace(/([-.*+?\^${}()|\[\]\/\\])/g,"\\$1")},getMeasureAlias:function(o,n){if(o.alias&&!n){return o.alias}else{var m=o.schemaName+"_"+o.queryName+"_"+o.name;return m.replace(/\//g,"_")}},collapseExpand:a,notifyExpandCollapse:f,toggleLink:d}};LABKEY.ActionURL=new function(){var c=a(window.location.pathname);function d(l){if(!l&&LABKEY.postParameters){return LABKEY.postParameters}if(!l){l=window.location.search}if(l.charAt(0)=="?"){l=l.substring(1,l.length)}var f=l.split("&");var j={};for(var h=0;h<f.length;h++){var e=f[h].split("=",2);if(e.length==1&&e[0]!=""){e[1]=""}if(e.length==2){var g=decodeURIComponent(e[0]);if(undefined==j[g]){j[g]=decodeURIComponent(e[1])}else{var k=j[g];if(LABKEY.Utils.isArray(k)){k.push(decodeURIComponent(e[1]))}else{j[g]=[k,decodeURIComponent(e[1])]}}}}return j}function b(g,h){var e=g.split("/");for(var f=0;f<e.length;f++){e[f]=h(e[f])}return e.join("/")}function a(j){var l=LABKEY.contextPath.length;var f=j.lastIndexOf("/");var i=j.substring(f+1);j=j.substring(l,f);var e=null;var k=i.indexOf("-");if(0<k){e=i.substring(0,k);i=i.substring(k+1)}else{var h=j.indexOf("/",1);if(h<0){e=j.substring(1)}else{e=j.substring(1,h)}j=j.substring(h)}var g=i.indexOf(".");if(0<g){i=i.substring(0,g)}return{controller:decodeURIComponent(e),action:decodeURIComponent(i),containerPath:decodeURI(j)}}return{getContextPath:function(){return LABKEY.contextPath},getAction:function(){return c.action},getContainer:function(){if(LABKEY.container&&LABKEY.container.path){return LABKEY.container.path}return c.containerPath},getContainerName:function(){var e=LABKEY.ActionURL.getContainer();var f=e.lastIndexOf("/");return e.substring(f+1)},getController:function(){return c.controller},getParameter:function(e){var f=d()[e];return(f&&LABKEY.Utils.isArray(f)&&f.length>0)?f[0]:f},getParameterArray:function(e){var f=d()[e];return(f&&!LABKEY.Utils.isArray(f))?[f]:f},getParameters:function(e){var f;if(!e){return d(e)}if(e.indexOf("?")!=-1){f=e.substring(e.indexOf("?")+1,e.length)}else{f=e}return d(f)},buildURL:function(e,i,f,g){if(!f){f=this.getContainer()}f=LABKEY.ActionURL.encodePath(f);if(f.charAt(0)!="/"){f="/"+f}if(f.charAt(f.length-1)!="/"){f=f+"/"}if(-1==i.indexOf(".")){i+=".view"}var h=LABKEY.ActionURL.queryString(g);var j;if(LABKEY.experimental&&LABKEY.experimental.containerRelativeURL){j=LABKEY.contextPath+f+e+"-"+i}else{j=LABKEY.contextPath+"/"+e+f+i}if(h){j+="?"+h}return j},encodePath:function(e){return b(e,encodeURIComponent)},decodePath:function(e){return b(e,decodeURIComponent)},queryString:function(i){if(!i){return""}var j="",h="",f,k,g;for(k in i){if(i.hasOwnProperty(k)){f=i[k];if(f===null||f===undefined){f=""}if(LABKEY.Utils.isArray(f)){for(var e=0;e<f.length;++e){g=f[e];j+=h+encodeURIComponent(k)+"="+encodeURIComponent(f[e]);h="&"}}else{j+=h+encodeURIComponent(k)+"="+encodeURIComponent(f);h="&"}}}return j},getBaseURL:function(e){return window.location.protocol+"//"+window.location.host+(e?"":LABKEY.ActionURL.getContextPath()+"/")}}};LABKEY.Ajax=new function(){var a=LABKEY.defaultHeaders;var e=function(h,g,f){if(h){h.apply(g,f)}};var c=function(i,h){if(h){var g=h.toLowerCase();for(var f in i){if(i.hasOwnProperty(f)&&f.toLowerCase()===g){return true}}}return false};var d=function(h){var g,k,l="GET",j,i=false;if(!h.hasOwnProperty("url")||h.url===null){throw new Error("a URL is required to make a request")}g=h.url;k=h.params;if(h.form){j=h.form instanceof FormData?h.form:new FormData(h.form);i=true}else{if(h.jsonData){j=JSON.stringify(h.jsonData)}else{j=null}}if(h.hasOwnProperty("method")&&h.method!==null){l=h.method.toUpperCase()}else{if(j){l="POST"}}if(k!==undefined&&k!==null){var f=LABKEY.ActionURL.queryString(k);if(l==="POST"&&(j===undefined||j===null)){j=f}else{g+=(g.indexOf("?")===-1?"?":"&")+f}}return{url:g,method:l,data:j,isForm:i}};var b=function(l,h,g){var j=h.headers,i=h.jsonData;if(j===undefined||j===null){j={}}if(!g.isForm&&!c(j,"Content-Type")){if(i!==undefined&&i!==null){j["Content-Type"]="application/json"}else{j["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"}}if(!c(j,"X-Requested-With")){j["X-Requested-With"]="XMLHttpRequest"}for(var f in a){if(a.hasOwnProperty(f)){l.setRequestHeader(f,a[f])}}for(var f in j){if(j.hasOwnProperty(f)){l.setRequestHeader(f,j[f])}}return j};return{DEFAULT_HEADERS:a,request:function(g){var f=d(g),h=g.hasOwnProperty("scope")&&g.scope!==null?g.scope:this,i=new XMLHttpRequest();i.onreadystatechange=function(){if(i.readyState===4){var j=(i.status>=200&&i.status<300)||i.status==304;e(j?g.success:g.failure,h,[i,g]);e(g.callback,h,[g,j,i])}};i.open(f.method,f.url,true);b(i,g,f);if(g.hasOwnProperty("timeout")&&g.timeout!==null){i.ontimeout=function(){e(g.failure,h,[i,g]);e(g.callback,h,[g,false,i])}}i.send(f.data);return i}}};LABKEY.Assay=new function(){function c(d){if(arguments.length>1){d={success:arguments[0],failure:arguments[1],parameters:arguments[2],containerPath:arguments[3]}}b(d,"id");b(d,"type");b(d,"name");LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("assay","assayList",d.containerPath),method:"POST",success:LABKEY.Utils.getOnSuccess(d),failure:LABKEY.Utils.getOnFailure(d),scope:d.scope||this,jsonData:d.parameters,headers:{"Content-Type":"application/json"}})}function a(d,e){return LABKEY.Utils.getCallbackWrapper(function(g,f){if(d){d.call(this,g.definitions,f)}},(e||this))}function b(d,e){if(!d.parameters){d.parameters={}}if(d[e]){d.parameters[e]=d[e];delete d[e]}}return{getAll:function(d){if(arguments.length>1){d={success:arguments[0],failure:arguments[1],parameters:{},containerPath:arguments[2]}}d.success=a(LABKEY.Utils.getOnSuccess(d),d.scope);c(d)},getByName:function(d){if(arguments.length>1){d={success:arguments[0],failure:arguments[1],parameters:{name:arguments[2]},containerPath:arguments[3]}}b(d,"name");d.success=a(LABKEY.Utils.getOnSuccess(d),d.scope);c(d)},getByType:function(d){if(arguments.length>1){d={success:arguments[0],failure:arguments[1],parameters:{type:arguments[2]},containerPath:arguments[3]}}b(d,"type");d.success=a(LABKEY.Utils.getOnSuccess(d),d.scope);c(d)},getById:function(d){if(arguments.length>1){d={success:arguments[0],failure:arguments[1],parameters:{id:arguments[2]},containerPath:arguments[3]}}b(d,"id");d.success=a(LABKEY.Utils.getOnSuccess(d),d.scope);c(d)},getNAbRuns:function(f){var g={};LABKEY.Utils.merge(g,f);if(f.sort){g["query.sort"]=f.sort}if(f.offset){g["query.offset"]=f.offset}if(f.maxRows){if(f.maxRows<0){g["query.showRows"]="all"}else{g["query.maxRows"]=f.maxRows}}LABKEY.Filter.appendFilterParams(g,f.filterArray);var d=LABKEY.Utils.getOnSuccess(f);var e={url:LABKEY.ActionURL.buildURL("nabassay","getNabRuns",f.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(i,h){if(d){d.call(f.scope,i.runs)}},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),params:g};if(LABKEY.Utils.isDefined(f.timeout)){e.timeout=f.timeout}LABKEY.Ajax.request(e)},getStudyNabRuns:function(f){var g={};LABKEY.Utils.merge(g,f);var d=LABKEY.Utils.getOnSuccess(f);var e={url:LABKEY.ActionURL.buildURL("nabassay","getStudyNabRuns",f.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(i,h){if(d){d.call(f.scope,i.runs)}},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f)||LABKEY.Utils.displayAjaxErrorResponse,f.scope,true),params:g};if(LABKEY.Utils.isDefined(f.timeout)){e.timeout=f.timeout}LABKEY.Ajax.request(e)},getStudyNabGraphURL:function(e){var f={};LABKEY.Utils.applyTranslated(f,e,{objectIds:"id"},true,false);var d={url:LABKEY.ActionURL.buildURL("nabassay","getStudyNabGraphURL",e.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(e),e.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(e)||LABKEY.Utils.displayAjaxErrorResponse,e.scope,true),params:f};if(LABKEY.Utils.isDefined(e.timeout)){d.timeout=e.timeout}LABKEY.Ajax.request(d)},importRun:function(e){if(!window.FormData){throw new Error("modern browser required")}if(!e.assayId){throw new Error("assayId required")}var k=[];if(e.files){for(var h=0;h<e.files.length;h++){var l=e.files[h];if(l instanceof window.File){k.push(l)}else{if(l.tagName=="INPUT"){for(var d=0;d<l.files.length;d++){k.push(l.files[d])}}}}}if(k.length==0&&!e.runFilePath&&!e.dataRows){throw new Error("At least one of 'file', 'runFilePath', or 'dataRows' is required")}if((k.length>0?1:0)+(e.runFilePath?1:0)+(e.dataRows?1:0)>1){throw new Error("Only one of 'file', 'runFilePath', or 'dataRows' is allowed")}var m=new FormData();m.append("assayId",e.assayId);if(e.name){m.append("name",e.name)}if(e.comment){m.append("comment",e.comment)}if(e.batchId){m.append("batchId",e.batchId)}if(e.properties){for(var g in e.properties){m.append("properties['"+g+"']",JSON.stringify(e.properties[g]))}}if(e.batchProperties){for(var g in e.batchProperties){m.append("batchProperties['"+g+"']",JSON.stringify(e.batchProperties[g]))}}if(e.dataRows){m.append("dataRows",JSON.stringify(e.dataRows))}if(e.runFilePath){m.append("runFilePath",e.runFilePath)}if(k&&k.length>0){m.append("file",k[0]);for(var h=1;h<k.length;h++){m.append("file"+h,k[h])}}LABKEY.Ajax.request({method:"POST",url:LABKEY.ActionURL.buildURL("assay","importRun.api",e.containerPath),success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(e),e.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(e),e.scope,true),form:m})}}};LABKEY.Domain=new function(){function c(h,f,g,e){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("property","createDomain.api",e),method:"POST",success:LABKEY.Utils.getCallbackWrapper(h),failure:LABKEY.Utils.getCallbackWrapper(f,this,true),jsonData:g,headers:{"Content-Type":"application/json"}})}function b(h,f,g,e){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("property","getDomain.api",e),method:"GET",success:LABKEY.Utils.getCallbackWrapper(h),failure:LABKEY.Utils.getCallbackWrapper(f,this,true),params:g})}function d(h,f,g,e){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("property","saveDomain.api",e),method:"POST",success:LABKEY.Utils.getCallbackWrapper(h),failure:LABKEY.Utils.getCallbackWrapper(f,this,true),jsonData:g,headers:{"Content-Type":"application/json"}})}function a(h,f,g,e){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("property","deleteDomain.api",e),method:"POST",success:LABKEY.Utils.getCallbackWrapper(h),failure:LABKEY.Utils.getCallbackWrapper(f,this,true),jsonData:g,headers:{"Content-Type":"application/json"}})}return{create:function(g){if(typeof g==="object"){c(g.success,g.failure,g,g.containerPath)}else{if(arguments.length>1){var i=arguments[0],f=arguments[1],h={},e;if((arguments.length==4||arguments.length==5)&&typeof arguments[3]==="string"){h.domainGroup=arguments[2];h.domainTemplate=arguments[3];e=arguments[4]}else{h.kind=arguments[2];h.domainDesign=arguments[3];h.options=arguments[4];e=arguments[5]}c(i,f,h,e)}}},get:function(e){if(arguments.length>1){e={success:arguments[0],failure:arguments[1],schemaName:arguments[2],queryName:arguments[3],containerPath:arguments[4]}}b(e.success,e.failure,{schemaName:e.schemaName,queryName:e.queryName},e.containerPath)},save:function(e){if(arguments.length>1){e={success:arguments[0],failure:arguments[1],domainDesign:arguments[2],schemaName:arguments[3],queryName:arguments[4],containerPath:arguments[5]}}d(e.success,e.failure,{domainDesign:e.domainDesign,schemaName:e.schemaName,queryName:e.queryName},e.containerPath)},drop:function(e){a(e.success,e.failure,{domainDesign:e.domainDesign,schemaName:e.schemaName,queryName:e.queryName},e.containerPath)}}};LABKEY.Experiment=new function(){function b(d,f,e){return function(h,i){var j=null;var g=null;if(h&&h.getResponseHeader&&h.getResponseHeader("Content-Type")&&h.getResponseHeader("Content-Type").indexOf("application/json")>=0){j=LABKEY.Utils.decode(h.responseText);g=d(j)}if(f){f.call(e||this,g,h)}}}function c(d,e){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("assay","saveAssayBatch",LABKEY.ActionURL.getContainer()),method:"POST",jsonData:{assayId:d.assayId,assayName:d.assayName,providerName:d.providerName,batches:d.batches},success:b(e,d.success,d.scope),failure:LABKEY.Utils.getCallbackWrapper(d.failure,d.scope,true),scope:d.scope,headers:{"Content-Type":"application/json"}})}function a(d){var e={};if(d.batches){e.batches=d.batches}else{e.batches=[];e.batches.push(d.batch)}e.assayId=d.assayId;e.assayName=d.assayName;e.providerName=d.providerName;e.scope=d.scope;e.success=LABKEY.Utils.getOnSuccess(d);e.failure=LABKEY.Utils.getOnFailure(d);return e}return{createHiddenRunGroup:function(d){function f(g){return new LABKEY.Exp.RunGroup(g)}var e={};if(d.runIds&&d.selectionKey){throw"Only one of runIds or selectionKey config parameter is allowed for a single call."}else{if(d.runIds){e.runIds=d.runIds}else{if(d.selectionKey){e.selectionKey=d.selectionKey}else{throw"Either the runIds or the selectionKey config parameter is required."}}}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("experiment","createHiddenRunGroup",d.containerPath),method:"POST",jsonData:e,success:b(f,LABKEY.Utils.getOnSuccess(d),d.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true),headers:{"Content-Type":"application/json"}})},loadBatch:function(d){function e(f){return new LABKEY.Exp.RunGroup(f.batch)}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("assay","getAssayBatch",LABKEY.ActionURL.getContainer()),method:"POST",success:b(e,LABKEY.Utils.getOnSuccess(d),d.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true),scope:d.scope,jsonData:{assayId:d.assayId,assayName:d.assayName,providerName:d.providerName,batchId:d.batchId},headers:{"Content-Type":"application/json"}})},loadBatches:function(d){function e(g){var h=[];if(g.batches){for(var f=0;f<g.batches.length;f++){h.push(new LABKEY.Exp.RunGroup(g.batches[f]))}}return h}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("assay","getAssayBatches",LABKEY.ActionURL.getContainer()),method:"POST",success:b(e,LABKEY.Utils.getOnSuccess(d),d.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true),scope:d.scope,jsonData:{assayId:d.assayId,assayName:d.assayName,providerName:d.providerName,batchIds:d.batchIds},headers:{"Content-Type":"application/json"}})},saveBatch:function(d){c(a(d),function(e){if(e.batches){return new LABKEY.Exp.RunGroup(e.batches[0])}})},saveBatches:function(d){c(a(d),function(f){var g=[];if(f.batches){for(var e=0;e<f.batches.length;e++){g.push(new LABKEY.Exp.RunGroup(f.batches[e]))}}return g})},saveMaterials:function(d){LABKEY.Query.insertRows({schemaName:"Samples",queryName:d.name,rows:d.materials,success:LABKEY.Utils.getOnSuccess(d),failure:LABKEY.Utils.getOnFailure(d),scope:d.scope})},lineage:function(d){var e={};if(d.rowId){e.rowId=d.rowId}else{if(d.lsid){e.lsid=d.lsid}}if(d.hasOwnProperty("parents")){e.parents=d.parents}if(d.hasOwnProperty("children")){e.children=d.children}if(d.hasOwnProperty("depth")){e.depth=d.depth}if(d.expType){e.expType=d.expType}if(d.cpasType){e.cpasType=d.cpasType}LABKEY.Ajax.request({method:"GET",url:LABKEY.ActionURL.buildURL("experiment","lineage.api"),params:e,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(d),d.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true),scope:d.scope})}}};if(typeof LABKEY.Exp=="undefined"){LABKEY.Exp={}}LABKEY.Exp.ExpObject=function(a){a=a||{};this.lsid=a.lsid;this.name=a.name;this.id=a.id||a.rowId;this.rowId=this.id;this.comment=a.comment;this.created=a.created;this.createdBy=a.createdBy;this.modified=a.modified;this.modifiedBy=a.modifiedBy;this.properties=a.properties||{}};LABKEY.Exp.Run=function(a){LABKEY.Exp.ExpObject.call(this,a);a=a||{};this.experiments=a.experiments||[];this.protocol=a.protocol;this.filePathRoot=a.filePathRoot;this.dataInputs=[];if(a.dataInputs){for(var b=0;b<a.dataInputs.length;b++){this.dataInputs.push(new LABKEY.Exp.Data(a.dataInputs[b]))}}this.dataOutputs=a.dataOutputs||[];this.dataRows=a.dataRows||[];this.materialInputs=a.materialInputs||[];this.materialOutputs=a.materialOutputs||[];this.objectProperties=a.objectProperties||{}};LABKEY.Exp.Run.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.Run.prototype.constructor=LABKEY.Exp.Run;LABKEY.Exp.Run.prototype.deleteRun=function(a){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("experiment","deleteRun"),method:"POST",params:{runId:this.id},success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),this,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),this,true)})};LABKEY.Exp.Protocol=function(a){LABKEY.Exp.ExpObject.call(this,a);a=a||{};this.instrument=a.instrument;this.software=a.software;this.contact=a.contact;this.childProtocols=a.childProtocols||[];this.steps=a.steps||[];this.applicationType=a.applicationType;this.description=a.description;this.runs=[];if(a.runs){for(var b=0;b<a.runs.length;b++){this.runs.push(new LABKEY.Exp.Run(a.runs[b]))}}};LABKEY.Exp.Protocol.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.Protocol.prototype.constructor=LABKEY.Exp.Protocol;LABKEY.Exp.RunGroup=function(a){LABKEY.Exp.ExpObject.call(this,a);a=a||{};this.batchProtocolId=a.batchProtocolId||0;this.runs=[];if(a.runs){for(var b=0;b<a.runs.length;b++){this.runs.push(new LABKEY.Exp.Run(a.runs[b]))}}this.hidden=a.hidden};LABKEY.Exp.RunGroup.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.RunGroup.prototype.constructor=LABKEY.Exp.RunGroup;LABKEY.Exp.ProtocolApplication=function(a){LABKEY.Exp.ExpObject.call(this,a);a=a||{}};LABKEY.Exp.ProtocolApplication.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.ProtocolApplication.prototype.constructor=LABKEY.Exp.ProtocolApplication;LABKEY.Exp.SampleSet=function(a){LABKEY.Exp.ExpObject.call(this,a);a=a||{};this.samples=a.samples;this.description=a.description};LABKEY.Exp.SampleSet.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.SampleSet.prototype.constructor=LABKEY.Exp.SampleSet;LABKEY.Exp.SampleSet.prototype.getDomain=function(a){LABKEY.Domain.get(LABKEY.Utils.getOnSuccess(a),LABKEY.Utils.getOnFailure(a),"Samples",this.name,a.containerPath)};LABKEY.Exp.SampleSet.create=function(a){LABKEY.Domain.create(LABKEY.Utils.getOnSuccess(a),LABKEY.Utils.getOnFailure(a),"SampleSet",a.domainDesign,a.options,a.containerPath)};LABKEY.Exp.DataClass=function(a){LABKEY.Exp.ExpObject.call(this,a);a=a||{};this.data=a.data;this.description=a.description;this.sampleSet=a.sampleSet};LABKEY.Exp.DataClass.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.DataClass.prototype.constructor=LABKEY.Exp.DataClass;LABKEY.Exp.DataClass.prototype.getDomain=function(a){LABKEY.Domain.get({success:LABKEY.Utils.getOnSuccess(a),failure:LABKEY.Utils.getOnFailure(a),schemaName:"exp.data",queryName:this.name,containerPath:a.containerPath})};LABKEY.Exp.DataClass.create=function(a){LABKEY.Domain.create({success:LABKEY.Utils.getOnSuccess(a),failure:LABKEY.Utils.getOnFailure(a),type:"dataclass",domainDesign:a.domainDesign,options:a.options,containerPath:a.containerPath})};LABKEY.Exp.ChildObject=function(a){LABKEY.Exp.ExpObject.call(this,a);a=a||{}};LABKEY.Exp.ChildObject.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.ChildObject.prototype.constructor=LABKEY.Exp.ChildObject;LABKEY.Exp.ProtocolOutput=function(a){LABKEY.Exp.ExpObject.call(this,a);a=a||{};this.sourceProtocol=a.sourceProtocol;this.run=a.run;this.targetApplications=a.targetApplications;this.sourceApplications=a.sourceApplications;this.sucessorRuns=a.sucessorRuns;this.cpasType=a.cpasType};LABKEY.Exp.ProtocolOutput.prototype=new LABKEY.Exp.ExpObject;LABKEY.Exp.ProtocolOutput.prototype.constructor=LABKEY.Exp.ProtocolOutput;LABKEY.Exp.Material=function(a){LABKEY.Exp.ProtocolOutput.call(this,a);a=a||{};this.sampleSet=a.sampleSet};LABKEY.Exp.Material.prototype=new LABKEY.Exp.ProtocolOutput;LABKEY.Exp.Material.prototype.constructor=LABKEY.Exp.Material;LABKEY.Exp.Data=function(a){LABKEY.Exp.ProtocolOutput.call(this,a);a=a||{};this.dataType=a.dataType;this.dataFileURL=a.dataFileURL;this.dataClass=a.dataClass;if(a.pipelinePath){this.pipelinePath=a.pipelinePath}if(a.role){this.role=a.role}};LABKEY.Exp.Data.prototype=new LABKEY.Exp.ProtocolOutput;LABKEY.Exp.Data.prototype.constructor=LABKEY.Exp.Data;LABKEY.Exp.Data.prototype.getContent=function(b){if(!LABKEY.Utils.getOnSuccess(b)){alert("You must specify a callback function in config.success when calling LABKEY.Exp.Data.getContent()!");return}function a(d,e,c){return function(f){var g=null;if(f&&f.getResponseHeader&&f.getResponseHeader("Content-Type")&&f.getResponseHeader("Content-Type").indexOf("application/json")>=0){g=LABKEY.Utils.decode(f.responseText)}else{g=f.responseText}if(d){d.call(c||this,g,e,f)}}}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("experiment","showFile"),method:"GET",params:{rowId:this.id,format:b.format},success:a(LABKEY.Utils.getOnSuccess(b),b.format,b.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(b),b.scope,true)})};LABKEY.QueryKey=function(b,a){if(b&&!(b instanceof b.constructor)){throw new Error("parent type not of same type as this")}this.parent=b;this.name=a};LABKEY.QueryKey.prototype.getName=function(){return this.name};LABKEY.QueryKey.prototype.equals=function(a){return a!=null&&this.constructor==a.constructor&&this.toString().toLowerCase()==a.toString().toLowerCase()};LABKEY.QueryKey.prototype.getParts=function(){var a=[];if(this.parent){a=this.parent.getParts()}a.push(this.name);return a};LABKEY.QueryKey.prototype.toString=function(b){var c=this.getParts();for(var a=0;a<c.length;a++){c[a]=LABKEY.QueryKey.encodePart(c[a])}return c.join(b)};LABKEY.QueryKey.prototype.toJSON=function(){return this.toString()};LABKEY.QueryKey.prototype.toDisplayString=function(){return this.getParts().join(".")};LABKEY.QueryKey.prototype.toSQLString=function(){var b=this.getParts();for(var a=0;a<b.length;a++){if(LABKEY.QueryKey.needsQuotes(b[a])){b[a]=LABKEY.QueryKey.quote(b[a])}}return b.join(".")};LABKEY.QueryKey.encodePart=function(a){return a.replace(/\$/g,"$D").replace(/\//g,"$S").replace(/\&/g,"$A").replace(/\}/g,"$B").replace(/\~/g,"$T").replace(/\,/g,"$C").replace(/\./g,"$P")};LABKEY.QueryKey.decodePart=function(a){return a.replace(/\$P/g,".").replace(/\$C/g,",").replace(/\$T/g,"~").replace(/\$B/g,"}").replace(/\$A/g,"&").replace(/\$S/g,"/").replace(/\$D/g,"$")};LABKEY.QueryKey.needsQuotes=function(a){if(!a.match(/^[a-zA-Z][_\$a-zA-Z0-9]*$/)){return true}if(a.match(/^(all|any|and|as|asc|avg|between|class|count|delete|desc|distinct|elements|escape|exists|false|fetch|from|full|group|having|in|indices|inner|insert|into|is|join|left|like|limit|max|min|new|not|null|or|order|outer|right|select|set|some|sum|true|union|update|user|versioned|where|case|end|else|then|when|on|both|empty|leading|member|of|trailing)$/i)){return true}return false};LABKEY.QueryKey.quote=function(a){return'"'+a.replace(/\"/g,'""')+'"'};LABKEY.SchemaKey=function(b,a){LABKEY.QueryKey.call(this,b,a)};LABKEY.SchemaKey.prototype=new LABKEY.QueryKey;LABKEY.SchemaKey.prototype.constructor=LABKEY.SchemaKey;LABKEY.SchemaKey.prototype.toString=function(){return LABKEY.QueryKey.prototype.toString.call(this,".")};LABKEY.SchemaKey.fromString=function(d){var c=d.split(".");var a=null;for(var b=0;b<c.length;b++){a=new LABKEY.SchemaKey(a,LABKEY.QueryKey.decodePart(c[b]))}return a};LABKEY.SchemaKey.fromParts=function(e){var c=null;for(var d=0;d<arguments.length;d++){var a=arguments[d];if(typeof a==="string"){c=new LABKEY.SchemaKey(c,a)}else{if(a&&a.length){for(var b=0;b<a.length;b++){c=new LABKEY.SchemaKey(c,a[b])}}else{throw"Illegal argument to fromParts: "+a}}}return c};LABKEY.FieldKey=function(b,a){LABKEY.QueryKey.call(this,b,a)};LABKEY.FieldKey.prototype=new LABKEY.QueryKey;LABKEY.FieldKey.prototype.constructor=LABKEY.FieldKey;LABKEY.FieldKey.prototype.toString=function(){return LABKEY.QueryKey.prototype.toString.call(this,"/")};LABKEY.FieldKey.fromString=function(d){var c=d.split("/");var a=null;for(var b=0;b<c.length;b++){a=new LABKEY.FieldKey(a,LABKEY.QueryKey.decodePart(c[b]))}return a};LABKEY.FieldKey.fromParts=function(){var c=null;for(var d=0;d<arguments.length;d++){var a=arguments[d];if(typeof a==="string"){c=new LABKEY.FieldKey(c,a)}else{if(a&&a.length){for(var b=0;b<a.length;b++){c=new LABKEY.FieldKey(c,a[b])}}else{throw"Illegal argument to fromParts: "+a}}}return c};LABKEY.Filter=new function(){function a(v,w,x,z,u,r){var y=w.split(z);var A="";var t="";for(var s=0;s<y.length;s++){var w=m(v,y[s].trim(),x);if(w==undefined){return undefined}A=A+t+w;t=z}if(u!==undefined&&u>0){if(y.length<u){alert("At least "+u+" '"+z+"' separated values are required");return undefined}}if(r!==undefined&&r>0){if(y.length>r){alert("At most "+r+" '"+z+"' separated values are allowed");return undefined}}return A}function m(x,C,D){if(x=="int"){var v=parseInt(C);if(isNaN(v)){alert(C+" is not a valid integer for field '"+D+"'.");return undefined}else{return""+v}}else{if(x=="float"){var t=parseFloat(C);if(isNaN(t)){alert(C+" is not a valid decimal number for field '"+D+"'.");return undefined}else{return""+t}}else{if(x=="date"){var y,u,z,s,r;s=0;r=0;if(C.match(/^\s*(\d\d\d\d)-(\d\d)-(\d\d)\s*$/)||C.match(/^\s*(\d\d\d\d)-(\d\d)-(\d\d)\s*(\d\d):(\d\d)\s*$/)){return C}else{var B=new Date(C);if(isNaN(B)){if(C.match(/^(-|\+)/i)){return C}alert(C+" is not a valid date for field '"+D+"'.");return undefined}if(C.match(/\d+\/\d+\/\d{2}(\D|$)/)){if(B.getFullYear()<new Date().getFullYear()-80){B.setFullYear(B.getFullYear()+100)}}y=B.getFullYear();u=B.getMonth()+1;z=B.getDate();s=B.getHours();r=B.getMinutes()}var w=""+y+"-"+b(u)+"-"+b(z);if(s!=0||r!=0){w+=" "+b(s)+":"+b(r)}return w}else{if(x=="boolean"){var A=C.toUpperCase();if(A=="TRUE"||C=="1"||A=="YES"||A=="Y"||A=="ON"||A=="T"){return"1"}if(A=="FALSE"||C=="0"||A=="NO"||A=="N"||A=="OFF"||A=="F"){return"0"}else{alert(C+" is not a valid boolean for field '"+D+"'. Try true,false; yes,no; y,n; on,off; or 1,0.");return undefined}}else{return C}}}}}function b(r){if(r<10){return"0"+r}else{return""+r}}var p={};var n={eq:"neqornull",dateeq:"dateneq",dateneq:"dateeq",neqornull:"eq",neq:"eq",isblank:"isnonblank",isnonblank:"isblank",gt:"lte",dategt:"datelte",lt:"gte",datelt:"dategte",gte:"lt",dategte:"datelt",lte:"gt",datelte:"dategt",contains:"doesnotcontain",doesnotcontain:"contains",doesnotstartwith:"startswith",startswith:"doesnotstartwith","in":"notin",notin:"in",memberof:"memberof",containsoneof:"containsnoneof",containsnoneof:"containsoneof",hasmvvalue:"nomvvalue",nomvvalue:"hasmvvalue",between:"notbetween",notbetween:"between"};var k={"in":"eq",containsoneof:"contains",containsnoneof:"doesnotcontain",between:"gte",notbetween:"lt"};var f={eq:"in",neq:"notin",neqornull:"notin",doesnotcontain:"containsnoneof",contains:"containsoneof"};function i(t,s,r,u){return e(t,s,r,false,false,null,u)}function h(t,s,r,u){return e(t,s,r,true,false,null,u)}function o(w,s,r,x,u,v,t){return e(w,s,r,true,false,u,x,v,t)}function q(t,s,r,u){return e(t,s,r,true,true,null,u)}function e(v,x,y,r,z,s,u,w,t){var A={getDisplaySymbol:function(){return x},getDisplayText:function(){return v},getLongDisplayText:function(){return u||v},getURLSuffix:function(){return y},isDataValueRequired:function(){return r===true},isMultiValued:function(){return s!=null},isTableWise:function(){return z===true},getMultiValueSeparator:function(){return s},getMultiValueMinOccurs:function(){return w},getMultiValueMaxOccurs:function(){return t},getOpposite:function(){return n[y]?p[n[y]]:null},getSingleValueFilter:function(){return this.isMultiValued()?p[k[y]]:this},getMultiValueFilter:function(){return this.isMultiValued()?null:p[f[y]]},validate:function(G,D,C){if(!r){return true}var F=d[D];var E=false;for(var B=0;!E&&B<F.length;B++){if(F[B].getURLSuffix()==y){E=true}}if(!E){alert("Filter type '"+v+"' can't be applied to "+D+" types.");return undefined}if(this.isMultiValued()){return a(D,G,C,s,w,t)}else{return m(D,G,C)}}};p[y]=A;return A}function l(r,u,t){var s=t.isTableWise()?"*":r;return{getColumnName:function(){return s},getValue:function(){return u},getFilterType:function(){return t},getURLParameterName:function(v){return(v||"query")+"."+s+"~"+t.getURLSuffix()},getURLParameterValue:function(){return t.isDataValueRequired()?u:""}}}var j={Types:{HAS_ANY_VALUE:i("Has Any Value",null,"",null),EQUAL:h("Equals","=","eq",null),DATE_EQUAL:h("Equals","=","dateeq",null),NEQ:h("Does Not Equal","<>","neq",null),NOT_EQUAL:h("Does Not Equal","<>","neq",null),DATE_NOT_EQUAL:h("Does Not Equal","<>","dateneq",null),NEQ_OR_NULL:h("Does Not Equal","<>","neqornull",null),NOT_EQUAL_OR_MISSING:h("Does Not Equal","<>","neqornull",null),GT:h("Is Greater Than",">","gt",null),GREATER_THAN:h("Is Greater Than",">","gt",null),DATE_GREATER_THAN:h("Is Greater Than",">","dategt",null),LT:h("Is Less Than","<","lt",null),LESS_THAN:h("Is Less Than","<","lt",null),DATE_LESS_THAN:h("Is Less Than","<","datelt",null),GTE:h("Is Greater Than or Equal To",">=","gte",null),GREATER_THAN_OR_EQUAL:h("Is Greater Than or Equal To",">=","gte",null),DATE_GREATER_THAN_OR_EQUAL:h("Is Greater Than or Equal To",">=","dategte",null),LTE:h("Is Less Than or Equal To","=<","lte",null),LESS_THAN_OR_EQUAL:h("Is Less Than or Equal To","=<","lte",null),DATE_LESS_THAN_OR_EQUAL:h("Is Less Than or Equal To","=<","datelte",null),STARTS_WITH:h("Starts With",null,"startswith",null),DOES_NOT_START_WITH:h("Does Not Start With",null,"doesnotstartwith",null),CONTAINS:h("Contains",null,"contains",null),DOES_NOT_CONTAIN:h("Does Not Contain",null,"doesnotcontain",null),CONTAINS_ONE_OF:o("Contains One Of",null,"containsoneof","Contains One Of (example usage: a;b;c)",";"),CONTAINS_NONE_OF:o("Does Not Contain Any Of",null,"containsnoneof","Does Not Contain Any Of (example usage: a;b;c)",";"),IN:o("Equals One Of",null,"in","Equals One Of (example usage: a;b;c)",";"),EQUALS_ONE_OF:o("Equals One Of",null,"in","Equals One Of (example usage: a;b;c)",";"),NOT_IN:o("Does Not Equal Any Of",null,"notin","Does Not Equal Any Of (example usage: a;b;c)",";"),EQUALS_NONE_OF:o("Does Not Equal Any Of",null,"notin","Does Not Equal Any Of (example usage: a;b;c)",";"),BETWEEN:o("Between",null,"between","Between, Inclusive (example usage: -4,4)",",",2,2),NOT_BETWEEN:o("Not Between",null,"notbetween","Not Between, Exclusive (example usage: -4,4)",",",2,2),MEMBER_OF:h("Member Of",null,"memberof","Member Of"),ISBLANK:i("Is Blank",null,"isblank",null),MISSING:i("Is Blank",null,"isblank",null),NONBLANK:i("Is Not Blank",null,"isnonblank",null),NOT_MISSING:i("Is Not Blank",null,"isnonblank",null),HAS_MISSING_VALUE:i("Has a missing value indicator",null,"hasmvvalue",null),DOES_NOT_HAVE_MISSING_VALUE:i("Does not have a missing value indicator",null,"nomvvalue",null),EXP_CHILD_OF:h("Is Child Of",null,"exp:childof"," is child of"),Q:q("Search",null,"q","Search across all columns")},appendFilterParams:function(y,s,t){t=t||"query";y=y||{};if(s){for(var u=0;u<s.length;u++){var v=s[u];if(v.getFilterType().isDataValueRequired()&&null==v.getURLParameterValue()){continue}var w=v.getURLParameterName(t);var x=v.getURLParameterValue();if(y[w]!==undefined){var r=y[w];if(!LABKEY.Utils.isArray(r)){r=[r]}r.push(x);x=r}y[w]=x}}return y},appendAggregateParams:function(u,w,t){t=t||"query";u=u||{};if(w){for(var y=0;y<w.length;++y){var r=w[y];var x="type="+r.type;if(r.label){x=x+"&label="+r.label}if(r.type&&r.column){var v=t+".analytics."+r.column;var s=encodeURIComponent(x);if(u[v]!==undefined){var z=u[v];if(!LABKEY.Utils.isArray(z)){z=[z]}z.push(s);s=z}u[v]=s}}}return u},create:function(r,t,s){if(!s){s=this.Types.EQUAL}return l(r,t,s)},_define:function(s,u,r,t){if(!LABKEY.Filter.Types[s]){if(t){LABKEY.Filter.Types[s]=o(u,null,r,null)}else{LABKEY.Filter.Types[s]=h(u,null,r,null)}}},merge:function(w,u,t){var s=[];if(null!=w){for(var v=0;v<w.length;v++){var r=w[v];if(r.getColumnName()!=u){s.push(r)}}}return null==t?s:s.concat(t)},getFilterDescription:function(s,v,u){var w=LABKEY.ActionURL.getParameters(s);var C="";var y="";for(var z in w){if(z.indexOf(v+"."+u+"~")==0){var r=z.substring(z.indexOf("~")+1);var B=w[z];if(!LABKEY.Utils.isArray(B)){B=[B]}var t=p[r];var A;if(!t){A=r}else{A=t.getDisplayText()}for(var x=0;x<B.length;x++){C+=y;y=" AND ";C+=A;C+=" ";C+=B[x]}}}return C},getFiltersFromUrl:function(s,u){u=u||"query";var v=LABKEY.ActionURL.getParameters(s);var y=[];for(var x in v){if(v.hasOwnProperty(x)){if(x.indexOf(u+".")==0){var z=x.indexOf("~");if(z!=-1){var t=x.substring(u.length+1,z);var w=x.substring(z+1);var r=LABKEY.Filter.getFilterTypeForURLSuffix(w);var A=v[x];if(!LABKEY.Utils.isArray(A)){A=[A]}y.push(LABKEY.Filter.create(t,A,r))}}}}return y},getSortFromUrl:function(s,r){r=r||"query";var t=LABKEY.ActionURL.getParameters(s);return t[r+".sort"]},getQueryParamsFromUrl:function(s,r){r=r||"query";var t={};var w=LABKEY.ActionURL.getParameters(s);for(var v in w){if(w.hasOwnProperty(v)){if(v.indexOf(r+".param.")==0){var u=v.substring((r+".param.").length);t[u]=w[v]}}}return t},getFilterTypeForURLSuffix:function(r){return p[r]}};var g=j.Types;var d={"int":[g.HAS_ANY_VALUE,g.EQUAL,g.NEQ_OR_NULL,g.ISBLANK,g.NONBLANK,g.GT,g.LT,g.GTE,g.LTE,g.IN,g.NOT_IN,g.BETWEEN,g.NOT_BETWEEN],string:[g.HAS_ANY_VALUE,g.EQUAL,g.NEQ_OR_NULL,g.ISBLANK,g.NONBLANK,g.GT,g.LT,g.GTE,g.LTE,g.CONTAINS,g.DOES_NOT_CONTAIN,g.DOES_NOT_START_WITH,g.STARTS_WITH,g.IN,g.NOT_IN,g.CONTAINS_ONE_OF,g.CONTAINS_NONE_OF,g.BETWEEN,g.NOT_BETWEEN],"boolean":[g.HAS_ANY_VALUE,g.EQUAL,g.NEQ_OR_NULL,g.ISBLANK,g.NONBLANK],"float":[g.HAS_ANY_VALUE,g.EQUAL,g.NEQ_OR_NULL,g.ISBLANK,g.NONBLANK,g.GT,g.LT,g.GTE,g.LTE,g.IN,g.NOT_IN,g.BETWEEN,g.NOT_BETWEEN],date:[g.HAS_ANY_VALUE,g.DATE_EQUAL,g.DATE_NOT_EQUAL,g.ISBLANK,g.NONBLANK,g.DATE_GREATER_THAN,g.DATE_LESS_THAN,g.DATE_GREATER_THAN_OR_EQUAL,g.DATE_LESS_THAN_OR_EQUAL]};var c={"int":g.EQUAL,string:g.CONTAINS,"boolean":g.EQUAL,"float":g.EQUAL,date:g.DATE_EQUAL};j.getFilterTypesForType=function(t,r){var s=[];if(d[t]){s=s.concat(d[t])}if(r){s.push(g.HAS_MISSING_VALUE);s.push(g.DOES_NOT_HAVE_MISSING_VALUE)}return s};j.getDefaultFilterForType=function(r){if(c[r]){return c[r]}return g.EQUAL};return j};LABKEY.List=new function(){return{create:function(b){var a={domainDesign:b,options:{}};if(!a.domainDesign.name){throw new Error("List name required")}if(!b.kind){if(b.keyType=="int"){b.kind="IntList"}else{if(b.keyType=="string"){b.kind="VarList"}}}if(b.kind!="IntList"&&b.kind!="VarList"){throw new Error("Domain kind or keyType required")}a.kind=b.kind;if(!b.keyName){throw new Error("List keyName required")}a.options.keyName=b.keyName;LABKEY.Domain.create(a)}}};LABKEY.Message=new function(){return{recipientType:{to:"TO",cc:"CC",bcc:"BCC"},msgType:{plain:"text/plain",html:"text/html"},sendMessage:function(a){var b={};if(a.msgFrom!=undefined){b.msgFrom=a.msgFrom}if(a.msgRecipients!=undefined){b.msgRecipients=a.msgRecipients}if(a.msgContent!=undefined){b.msgContent=a.msgContent}if(a.msgSubject!=undefined){b.msgSubject=a.msgSubject}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("announcements","sendMessage"),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true),jsonData:b,headers:{"Content-Type":"application/json"}})},createMsgContent:function(a,b){return{type:a,content:b}},createRecipient:function(b,a){return{type:b,address:a}},createPrincipalIdRecipient:function(a,b){return{type:a,principalId:b}}}};LABKEY.MultiRequest=function(c){c=c||{};var n=this;var k=false;var e=[];var d=[];var a;var l;if(LABKEY.Utils.isArray(c)){a=c}else{a=c.requests;l=c.listeners}if(a){for(var g=0;g<a.length;g++){var f=a[g];this.add(f[0],f[1])}}var b=[];if(l&&l.done){if(typeof l.done=="function"){b.push({fn:l.done,scope:l.scope})}else{if(typeof l.done.fn=="function"){b.push({fn:l.done.fn,scope:l.done.scope||l.scope})}}}if(e.length&&b.length>0){this.send()}function j(){for(var p=0;p<b.length;p++){var o=b[p];if(o.fn&&typeof o.fn=="function"){o.fn.call(o.scope||window)}}}function m(){d.pop();if(d.length==0){k=false;j();n.send()}return true}function h(o,i,p){return function(){var q=o.apply(p||this||window,arguments);i.apply(p||this||window,arguments);return q}}this.add=function(q,o,p){o=o||{};var r=LABKEY.Utils.getOnSuccess(o);if(!r){r=function(){}}if(!r._hookInstalled){o.success=h(r,m,o.scope);o.success._hookInstalled=true}var i=LABKEY.Utils.getOnFailure(o);if(!i){i=function(){}}if(!i._hookInstalled){o.failure=h(i,m,o.scope);o.failure._hookInstalled=true}e.push({fn:q,args:[o],scope:p});return this};this.send=function(u,s){if(k||e.length==0){return}k=true;d=e;e=new Array();var o=d.length;for(var r=0;r<o;r++){var t=d[r];t.fn.apply(t.scope||window,t.args)}var p=this;if(typeof u=="function"){b.push({fn:u,scope:s})}else{if(typeof u.fn=="function"){b.push({fn:u.fn,scope:u.scope||s})}}}};LABKEY.ParticipantGroup=new function(){function a(d,c){return LABKEY.Utils.getCallbackWrapper(function(e){d(c?e[c]:e)},this)}function b(c){LABKEY.Ajax.request({url:c.url,method:c.method||"POST",success:c.success,failure:c.failure,jsonData:c.jsonData,headers:{"Content-Type":"application/json"}})}return{updateParticipantGroup:function(c){var d={};if(c.rowId){d.rowId=c.rowId}if(c.participantIds){d.participantIds=c.participantIds}if(c.ensureParticipantIds){d.ensureParticipantIds=c.ensureParticipantIds}if(c.deleteParticipantIds){d.deleteParticipantIds=c.deleteParticipantIds}if(c.label){d.label=c.label}if(c.description){d.description=c.description}if(c.filters){d.filters=c.filters}b({url:LABKEY.ActionURL.buildURL("participant-group","updateParticipantGroup.api",c.containerPath),success:a(c.success,"group"),failure:LABKEY.Utils.getCallbackWrapper(c.failure,this,true),jsonData:d})}}};LABKEY.Pipeline=new function(){return{getPipelineContainer:function(a){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("pipeline","getPipelineContainer.api",a.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},getProtocols:function(c){var e={taskId:c.taskId,includeWorkbooks:!!c.includeWorkbooks,path:c.path};var a=c.containerPath?c.containerPath:LABKEY.ActionURL.getContainer();var b=LABKEY.ActionURL.buildURL("pipeline-analysis","getSavedProtocols.api",a);var d=LABKEY.Utils.getOnSuccess(c);LABKEY.Ajax.request({url:b,method:"POST",params:e,success:LABKEY.Utils.getCallbackWrapper(function(g,f){d.call(this,g.protocols,g.defaultProtocolName,f)},c.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(c),c.scope,true)})},getFileStatus:function(c){var e={taskId:c.taskId,path:c.path,file:c.files,protocolName:c.protocolName};var a=c.containerPath?c.containerPath:LABKEY.ActionURL.getContainer();var b=LABKEY.ActionURL.buildURL("pipeline-analysis","getFileStatus.api",a);var d=LABKEY.Utils.getOnSuccess(c);LABKEY.Ajax.request({url:b,method:"POST",timeout:60000000,params:e,success:LABKEY.Utils.getCallbackWrapper(function(g,f){d.call(this,g.files,g.submitType,f)},c.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(c),c.scope,true)})},startAnalysis:function(c){if(!c.protocolName){throw"Invalid config, must include protocolName property"}var d={taskId:c.taskId,path:c.path,protocolName:c.protocolName,protocolDescription:c.protocolDescription,file:c.files,fileIds:c.fileIds,allowNonExistentFiles:c.allowNonExistentFiles,pipelineDescription:c.pipelineDescription,saveProtocol:c.saveProtocol==undefined||c.saveProtocol};if(c.xmlParameters){if(typeof c.xmlParameters=="object"){throw new Error("The xml configuration is deprecated, please use the jsonParameters option to specify your protocol description.")}else{d.configureXml=c.xmlParameters}}else{if(c.jsonParameters){if(LABKEY.Utils.isString(c.jsonParameters)){d.configureJson=c.jsonParameters}else{d.configureJson=LABKEY.Utils.encode(c.jsonParameters)}}}var a=c.containerPath?c.containerPath:LABKEY.ActionURL.getContainer();var b=LABKEY.ActionURL.buildURL("pipeline-analysis","startAnalysis.api",a);LABKEY.Ajax.request({url:b,method:"POST",params:d,timeout:60000000,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(c),c.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(c),c.scope,true)})}}};LABKEY.Specimen=new function(){function a(d,c){return LABKEY.Utils.getCallbackWrapper(function(e){d(c?e[c]:e)},this)}function b(c){LABKEY.Ajax.request({url:c.url,method:c.method||"POST",success:c.success,failure:c.failure,jsonData:c.jsonData,headers:{"Content-Type":"application/json"}})}return{getRepositories:function(c){if(c&&(LABKEY.Utils.isFunction(c)||arguments.length>1)){c={success:arguments[0],failure:arguments[1],containerPath:arguments[2]}}b({url:LABKEY.ActionURL.buildURL("study-samples-api","getRespositories",c.containerPath),success:a(c.success,"repositories"),failure:LABKEY.Utils.getCallbackWrapper(c.failure||LABKEY.Utils.displayAjaxErrorResponse,this,true)})},getVialsByRowId:function(c){if(c&&(LABKEY.Utils.isFunction(c)||arguments.length>1)){c={success:arguments[0],vialRowIdArray:arguments[1],failure:arguments[2],containerPath:arguments[3]}}b({url:LABKEY.ActionURL.buildURL("study-samples-api","getVialsByRowId",c.containerPath),success:a(c.success,"vials"),failure:LABKEY.Utils.getCallbackWrapper(c.failure||LABKEY.Utils.displayAjaxErrorResponse,this,true),jsonData:{rowIds:c.vialRowIdArray}})},getOpenRequests:function(c){if(c&&(LABKEY.Utils.isFunction(c)||arguments.length>1)){c={success:arguments[0],allUsers:arguments[1],failure:arguments[2],containerPath:arguments[3]}}if(!c.failure){c.failure=function(e,d){return LABKEY.Utils.displayAjaxErrorResponse(d,e)}}b({url:LABKEY.ActionURL.buildURL("study-samples-api","getOpenRequests",c.containerPath),success:a(c.success,"requests"),failure:LABKEY.Utils.getCallbackWrapper(c.failure,this,true),jsonData:{allUsers:c.allUsers}})},getProvidingLocations:function(c){if(c&&(LABKEY.Utils.isFunction(c)||arguments.length>1)){c={success:arguments[0],specimenHashArray:arguments[1],failure:arguments[2],containerPath:arguments[3]}}if(!c.failure){c.failure=function(e,d){return LABKEY.Utils.displayAjaxErrorResponse(d,e)}}b({url:LABKEY.ActionURL.buildURL("study-samples-api","getProvidingLocations",c.containerPath),success:a(c.success,"locations"),failure:LABKEY.Utils.getCallbackWrapper(c.failure,this,true),jsonData:{specimenHashes:c.specimenHashArray}})},getVialTypeSummary:function(c){if(!c.failure){c.failure=function(e,d){return LABKEY.Utils.displayAjaxErrorResponse(d,e)}}b({url:LABKEY.ActionURL.buildURL("study-samples-api","getVialTypeSummary",c.containerPath),success:a(c.success),failure:LABKEY.Utils.getCallbackWrapper(c.failure,this,true)})},getSpecimenWebPartGroups:function(c){if(!c.failure){c.failure=function(e,d){return LABKEY.Utils.displayAjaxErrorResponse(d,e)}}b({url:LABKEY.ActionURL.buildURL("study-samples-api","getSpecimenWebPartGroups",c.containerPath),success:a(c.success),failure:LABKEY.Utils.getCallbackWrapper(c.failure,this,true)})},getRequest:function(c){if(c&&LABKEY.Utils.isFunction(c)||arguments.length>1){c={success:arguments[0],requestId:arguments[1],failure:arguments[2],containerPath:arguments[3]}}if(!c.failure){c.failure=function(e,d){return LABKEY.Utils.displayAjaxErrorResponse(d,e)}}b({url:LABKEY.ActionURL.buildURL("study-samples-api","getRequest",c.containerPath),success:a(c.success,"request"),failure:LABKEY.Utils.getCallbackWrapper(c.failure,this,true),jsonData:{requestId:c.requestId}})},cancelRequest:function(c){if(c&&(LABKEY.Utils.isFunction(c)||arguments.length>1)){c={success:arguments[0],requestId:arguments[1],failure:arguments[2],containerPath:arguments[3]}}if(!c.failure){c.failure=function(e,d){return LABKEY.Utils.displayAjaxErrorResponse(d,e)}}b({url:LABKEY.ActionURL.buildURL("study-samples-api","cancelRequest",c.containerPath),success:a(c.success),failure:LABKEY.Utils.getCallbackWrapper(c.failure,this,true),jsonData:{requestId:c.requestId}})},addVialsToRequest:function(c){if(c&&(LABKEY.Utils.isFunction(c)||arguments.length>1)){c={success:arguments[0],requestId:arguments[1],vialIdArray:arguments[2],idType:arguments[3],failure:arguments[4],containerPath:arguments[5]}}if(!c.failure){c.failure=function(e,d){return LABKEY.Utils.displayAjaxErrorResponse(d,e)}}if(!c.idType){c.idType="GlobalUniqueId"}b({url:LABKEY.ActionURL.buildURL("study-samples-api","addVialsToRequest",c.containerPath),success:a(c.success),failure:LABKEY.Utils.getCallbackWrapper(c.failure,this,true),jsonData:{requestId:c.requestId,vialIds:c.vialIdArray,idType:c.idType}})},addSamplesToRequest:function(d){if(d&&(LABKEY.Utils.isFunction(d)||arguments.length>1)){d={success:arguments[0],requestId:arguments[1],specimenHashArray:arguments[2],preferredLocation:arguments[3],failure:arguments[4],containerPath:arguments[5]}}var c=LABKEY.Utils.getOnFailure(d);var e=LABKEY.Utils.getOnSuccess(d);if(!c){c=function(g,f){return LABKEY.Utils.displayAjaxErrorResponse(f,g)}}b({url:LABKEY.ActionURL.buildURL("study-samples-api","addSamplesToRequest",d.containerPath),success:a(e),failure:LABKEY.Utils.getCallbackWrapper(c,this,true),jsonData:{requestId:d.requestId,specimenHashes:d.specimenHashArray,preferredLocation:d.preferredLocation}})},removeVialsFromRequest:function(c){if(c&&(LABKEY.Utils.isFunction(c)||arguments.length>1)){c={success:arguments[0],requestId:arguments[1],vialIdArray:arguments[2],idType:arguments[3],failure:arguments[4],containerPath:arguments[5]}}if(!c.failure){c.failure=function(e,d){return LABKEY.Utils.displayAjaxErrorResponse(d,e)}}if(!c.idType){c.idType="GlobalUniqueId"}b({url:LABKEY.ActionURL.buildURL("study-samples-api","removeVialsFromRequest",c.containerPath),success:a(c.success),failure:LABKEY.Utils.getCallbackWrapper(c.failure,this,true),jsonData:{requestId:c.requestId,vialIds:c.vialIdArray,idType:c.idType}})}}};LABKEY.Query=new function(){function c(g){var h={schemaName:g.schemaName,queryName:g.queryName,rows:g.rows||g.rowDataArray,transacted:g.transacted,extraContext:g.extraContext};var f={url:LABKEY.ActionURL.buildURL("query",g.action,g.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(g),g.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(g),g.scope,true),jsonData:h,headers:{"Content-Type":"application/json"}};if(LABKEY.Utils.isDefined(g.timeout)){f.timeout=g.timeout}return LABKEY.Ajax.request(f)}function b(f,i,g,h){if(h&&(h===13.2||h==="13.2"||h===16.2||h===17.1)){return LABKEY.Utils.getCallbackWrapper(function(l,j,k){if(l&&f){f.call(g||this,new LABKEY.Query.Response(l),j,k)}},this)}return LABKEY.Utils.getCallbackWrapper(function(l,j,k){if(l&&l.rows&&i){a(l)}if(f){f.call(g||this,l,k,j)}},this)}function a(j){var m=[];var l=[];var h=[];var g=j.columnModel;for(var f=0;f<g.length;++f){if(g[f].hidden){m.push(g[f].dataIndex)}else{l.push(g[f]);h.push(j.metaData.fields[f])}}j.columnModel=l;j.metaData.fields=h;var k;for(f=0;f<j.rows.length;++f){k=j.rows[f];for(var i=0;i<m.length;++i){delete k[m[i]];delete k[LABKEY.Query.URL_COLUMN_PREFIX+m[i]]}}}function d(f){return{schemaName:f[0],queryName:f[1],rows:f[2],successCallback:f[3],errorCallback:f[4]}}function e(f){if(f&&(f.toUpperCase()==="GET"||f.toUpperCase()==="POST")){return f.toUpperCase()}return"GET"}return{containerFilter:{current:"Current",currentAndFirstChildren:"CurrentAndFirstChildren",currentAndSubfolders:"CurrentAndSubfolders",currentPlusProject:"CurrentPlusProject",currentAndParents:"CurrentAndParents",currentPlusProjectAndShared:"CurrentPlusProjectAndShared",allFolders:"AllFolders"},executeSql:function(g){var i={schemaName:g.schemaName,sql:g.sql};if(g.saveInSession!==undefined&&g.saveInSession!==null){i.saveInSession=g.saveInSession}if(g.maxRows!==undefined&&g.maxRows>=0){i.maxRows=g.maxRows}if(g.offset&&g.offset>0){i.offset=g.offset}if(g.includeTotalCount!=undefined){i.includeTotalCount=g.includeTotalCount}if(g.containerFilter){i.containerFilter=g.containerFilter}if(g.requiredVersion){i.apiVersion=g.requiredVersion}if(g.includeStyle){i.includeStyle=g.includeStyle}var h={};if(g.sort){h["query.sort"]=g.sort}if(g.parameters){for(var j in g.parameters){if(g.parameters.hasOwnProperty(j)){h["query.param."+j]=g.parameters[j]}}}var f={url:LABKEY.ActionURL.buildURL("query","executeSql.api",g.containerPath,h),method:"POST",success:b(LABKEY.Utils.getOnSuccess(g),g.stripHiddenColumns,g.scope,g.requiredVersion),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(g),g.scope,true),jsonData:i,headers:{"Content-Type":"application/json"}};if(LABKEY.Utils.isDefined(g.timeout)){f.timeout=g.timeout}return LABKEY.Ajax.request(f)},importData:function(f){if(!window.FormData){throw new Error("modern browser required")}var g=new FormData();g.append("schemaName",f.schemaName);g.append("queryName",f.queryName);if(f.text){g.append("text",f.text)}if(f.path){g.append("path",f.path)}if(f.format){g.append("format",f.format)}if(f.module){g.append("module",f.module)}if(f.moduleResource){g.append("moduleResource",f.moduleResource)}if(f.importIdentity){g.append("importIdentity",f.importIdentity)}if(f.importLookupByAlternateKey){g.append("importLookupByAlternateKey",f.importLookupByAlternateKey)}if(f.file){if(f.file instanceof File){g.append("file",f.file)}else{if(f.file.tagName=="INPUT"&&f.file.files.length>0){g.append("file",f.file.files[0])}}}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","import.api",f.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(f),f.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),form:g,timeout:f.timeout})},selectRows:function(g){if(arguments.length>1){g={schemaName:arguments[0],queryName:arguments[1],success:arguments[2],errorCallback:arguments[3],filterArray:arguments[4],sort:arguments[5],viewName:arguments[6]}}if(!g.schemaName){throw"You must specify a schemaName!"}if(!g.queryName){throw"You must specify a queryName!"}g.dataRegionName=g.dataRegionName||"query";var h=LABKEY.Query.buildQueryParams(g.schemaName,g.queryName,g.filterArray,g.sort,g.dataRegionName);if(!g.showRows||g.showRows=="paginated"){if(g.offset){h[g.dataRegionName+".offset"]=g.offset}if(g.maxRows!=undefined){if(g.maxRows<0){h[g.dataRegionName+".showRows"]="all"}else{h[g.dataRegionName+".maxRows"]=g.maxRows}}}else{if(g.showRows in {all:true,selected:true,unselected:true,none:true}){h[g.dataRegionName+".showRows"]=g.showRows}}if(g.viewName){h[g.dataRegionName+".viewName"]=g.viewName}if(g.columns){h[g.dataRegionName+".columns"]=LABKEY.Utils.isArray(g.columns)?g.columns.join(","):g.columns}if(g.selectionKey){h[g.dataRegionName+".selectionKey"]=g.selectionKey}if(g.ignoreFilter){h[g.dataRegionName+".ignoreFilter"]=1}if(g.parameters){for(var i in g.parameters){if(g.parameters.hasOwnProperty(i)){h[g.dataRegionName+".param."+i]=g.parameters[i]}}}if(g.requiredVersion){h.apiVersion=g.requiredVersion}if(g.containerFilter){h.containerFilter=g.containerFilter}if(g.includeTotalCount){h.includeTotalCount=g.includeTotalCount}if(g.includeDetailsColumn){h.includeDetailsColumn=g.includeDetailsColumn}if(g.includeUpdateColumn){h.includeUpdateColumn=g.includeUpdateColumn}if(g.includeStyle){h.includeStyle=g.includeStyle}var f={url:LABKEY.ActionURL.buildURL("query","getQuery.api",g.containerPath),method:e(g.method),success:b(LABKEY.Utils.getOnSuccess(g),g.stripHiddenColumns,g.scope,g.requiredVersion),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(g),g.scope,true),params:h};if(LABKEY.Utils.isDefined(g.timeout)){f.timeout=g.timeout}return LABKEY.Ajax.request(f)},selectDistinctRows:function(f){if(!f.schemaName){throw"You must specify a schemaName!"}if(!f.queryName){throw"You must specify a queryName!"}if(!f.column){throw"You must specify a column!"}f.dataRegionName=f.dataRegionName||"query";var g=LABKEY.Query.buildQueryParams(f.schemaName,f.queryName,f.filterArray,f.sort,f.dataRegionName);g[f.dataRegionName+".columns"]=f.column;if(f.viewName){g[f.dataRegionName+".viewName"]=f.viewName}if(f.maxRows&&f.maxRows>=0){g.maxRows=f.maxRows}if(f.containerFilter){g.containerFilter=f.containerFilter}if(f.parameters){for(var h in f.parameters){if(f.parameters.hasOwnProperty(h)){g[f.dataRegionName+".param."+h]=f.parameters[h]}}}if(f.ignoreFilter){g[f.dataRegionName+".ignoreFilter"]=true}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","selectDistinct.api",f.containerPath),method:e(f.method),success:b(LABKEY.Utils.getOnSuccess(f),false,f.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),params:g})},getDataViews:function(g){var h={includeData:true,includeMetadata:false};if(g.dataTypes){h.dataTypes=g.dataTypes}var f=LABKEY.Utils.getOnSuccess(g);var i=LABKEY.Utils.getCallbackWrapper(function(l,j,k){if(f){f.call(g.scope||this,l.data,k,j)}},this);return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","browseData.api",g.containerPath),method:"POST",success:i,failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(g),g.scope,true),jsonData:h,headers:{"Content-Type":"application/json"}})},updateRows:function(f){if(arguments.length>1){f=d(arguments)}f.action="updateRows.api";return c(f)},saveRows:function(g){if(arguments.length>1){g=d(arguments)}var h={commands:g.commands,containerPath:g.containerPath,validateOnly:g.validateOnly,transacted:g.transacted,extraContext:g.extraContext,apiVersion:g.apiVersion};var f={url:LABKEY.ActionURL.buildURL("query","saveRows.api",g.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(g),g.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(g),g.scope,true),jsonData:h,headers:{"Content-Type":"application/json"}};if(LABKEY.Utils.isDefined(g.timeout)){f.timeout=g.timeout}return LABKEY.Ajax.request(f)},insertRows:function(f){if(arguments.length>1){f=d(arguments)}f.action="insertRows.api";return c(f)},deleteRows:function(f){if(arguments.length>1){f=d(arguments)}f.action="deleteRows.api";return c(f)},deleteQueryView:function(f){if(!f){throw"You must specify a configuration!"}if(!f.schemaName){throw"You must specify a schemaName!"}if(!f.queryName){throw"You must specify a queryName!"}var g={schemaName:f.schemaName,queryName:f.queryName};if(f.viewName){g.viewName=f.viewName}if(f.revert!==undefined){g.complete=f.revert!==true}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","deleteView.api",f.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(f),f.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),jsonData:g})},buildQueryParams:function(k,j,f,h,g){g=g||"query";var i={};i.dataRegionName=g;i[g+".queryName"]=j;i.schemaName=k;if(h){i[g+".sort"]=h}LABKEY.Filter.appendFilterParams(i,f,g);return i},getSchemas:function(f){var g={};if(f.apiVersion){g.apiVersion=f.apiVersion}if(f.schemaName){g.schemaName=f.schemaName}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getSchemas.api",f.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(f),f.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),params:g})},getQueries:function(f){var g={};LABKEY.Utils.applyTranslated(g,f,{schemaName:"schemaName",includeColumns:"includeColumns",includeUserQueries:"includeUserQueries",includeSystemQueries:"includeSystemQueries"},false,false);return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getQueries.api",f.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(f),f.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),params:g})},getQueryViews:function(f){var g={};if(f.schemaName){g.schemaName=f.schemaName}if(f.queryName){g.queryName=f.queryName}if(f.viewName!=undefined){g.viewName=f.viewName}if(f.metadata){g.metadata=f.metadata}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getQueryViews.api",f.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(f),f.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),params:g})},saveQueryViews:function(f){var g={};if(f.schemaName){g.schemaName=f.schemaName}if(f.queryName){g.queryName=f.queryName}if(f.views){g.views=f.views}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","saveQueryViews.api",f.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(f),f.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),jsonData:g,headers:{"Content-Type":"application/json"}})},getQueryDetails:function(f){var g={};if(f.schemaName){g.schemaName=f.schemaName}if(f.queryName){g.queryName=f.queryName}if(f.viewName!=undefined){g.viewName=f.viewName}if(f.fields){g.fields=f.fields}if(f.fk){g.fk=f.fk}if(f.initializeMissingView){g.initializeMissingView=f.initializeMissingView}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getQueryDetails.api",f.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(f),f.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),params:g})},validateQuery:function(f){var g={};LABKEY.Utils.applyTranslated(g,f,{successCallback:false,errorCallback:false,scope:false});return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query",(f.validateQueryMetadata?"validateQueryMetadata.api":"validateQuery.api"),f.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(f),f.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope,true),params:g})},getServerDate:function(f){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("query","getServerDate.api"),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(f),f.scope),success:LABKEY.Utils.getCallbackWrapper(function(g){var i;var h=LABKEY.Utils.getOnSuccess(f);if(g&&g.date&&h){i=new Date(g.date);h(i)}},this)})},sqlDateTimeLiteral:function(h,i){if(h===undefined||h===null||!h){return"NULL"}if(typeof h=="string"){try{h=new Date(h)}catch(g){}}if(typeof h=="object"&&typeof h.toISOString=="function"){var f=function(k){return(k>=10?""+k:"0"+k)};var j=function(k){return(k>=100?""+k:"0"+f(k))};return"{ts '"+h.getFullYear()+"-"+f(h.getMonth()+1)+"-"+f(h.getDate())+" "+f(h.getHours())+":"+f(h.getMinutes())+":"+f(h.getSeconds())+(i?"."+j(h.getMilliseconds()):"")+"'}"}return"{ts '"+this.sqlStringLiteral(h)+"'}"},sqlDateLiteral:function(h){if(h===undefined||h===null||!h){return"NULL"}if(typeof h=="string"){try{h=new Date(h)}catch(g){}}if(typeof h=="object"&&typeof h.toISOString=="function"){var f=function(j){return(j>=10?j:"0"+j)};var i=function(j){return(j>=999?j:"0"+f(j))};return"{d '"+h.getFullYear()+"-"+f(h.getMonth()+1)+"-"+f(h.getDate())+"'}"}return"{d '"+this.sqlStringLiteral(h)+"'}"},sqlStringLiteral:function(f){if(f===undefined||f===null||f==""){return"NULL"}f=f.toString();return"'"+f.replace("'","''")+"'"},URL_COLUMN_PREFIX:"_labkeyurl_"}};LABKEY.Query.Filter=function(a,c,b){if(a){if(a instanceof LABKEY.FieldKey){a=a.toString()}else{if(a instanceof Array){a=a.join("/")}}}if(!b){b=LABKEY.Filter.Types.EQUAL}this.columnName=a;this.value=c;this.filterType=b};LABKEY.Query.Filter.prototype.getColumnName=function(){return this.columnName};LABKEY.Query.Filter.prototype.getFilterType=function(){return this.filterType};LABKEY.Query.Filter.prototype.getValue=function(){return this.value};LABKEY.Query.Filter.prototype.getURLParameterValue=function(){return this.filterType.isDataValueRequired()?this.value:""};LABKEY.Query.Filter.prototype.getURLParameterName=function(a){return(a||"query")+"."+this.columnName+"~"+this.filterType.getURLSuffix()};LABKEY.Query.Filter.HasAnyValue=function(a){LABKEY.Query.Filter.call(this,a,null,LABKEY.Filter.Types.HAS_ANY_VALUE)};LABKEY.Query.Filter.HasAnyValue.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Equal=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.EQUAL)};LABKEY.Query.Filter.Equal.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateEqual=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.DATE_EQUAL)};LABKEY.Query.Filter.DateEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateNotEqual=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.DATE_NOT_EQUAL)};LABKEY.Query.Filter.DateNotEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotEqualOrNull=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.NEQ_OR_NULL)};LABKEY.Query.Filter.NotEqualOrNull.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotEqualOrMissing=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.NOT_EQUAL_OR_MISSING)};LABKEY.Query.Filter.NotEqualOrMissing.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotEqual=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.NOT_EQUAL)};LABKEY.Query.Filter.NotEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Neq=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.NEQ)};LABKEY.Query.Filter.Neq.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.IsBlank=function(a){LABKEY.Query.Filter.call(this,a,null,LABKEY.Filter.Types.ISBLANK)};LABKEY.Query.Filter.IsBlank.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Missing=function(a){LABKEY.Query.Filter.call(this,a,null,LABKEY.Filter.Types.MISSING)};LABKEY.Query.Filter.Missing.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NonBlank=function(a){LABKEY.Query.Filter.call(this,a,null,LABKEY.Filter.Types.NONBLANK)};LABKEY.Query.Filter.NonBlank.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotMissing=function(a){LABKEY.Query.Filter.call(this,a,null,LABKEY.Filter.Types.NOT_MISSING)};LABKEY.Query.Filter.NotMissing.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Gt=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.GT)};LABKEY.Query.Filter.Gt.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.GreaterThan=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.GREATER_THAN)};LABKEY.Query.Filter.GreaterThan.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Lt=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.LT)};LABKEY.Query.Filter.Lt.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.LessThan=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.LESS_THAN)};LABKEY.Query.Filter.LessThan.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateLessThan=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.DATE_LESS_THAN)};LABKEY.Query.Filter.DateLessThan.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Gte=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.GTE)};LABKEY.Query.Filter.Gte.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.GreaterThanOrEqual=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.GREATER_THAN_OR_EQUAL)};LABKEY.Query.Filter.GreaterThanOrEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateGreaterThanOrEqual=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.DATE_GREATER_THAN_OR_EQUAL)};LABKEY.Query.Filter.DateGreaterThanOrEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Lte=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.LTE)};LABKEY.Query.Filter.Lte.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.LessThanOrEqual=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.LESS_THAN_OR_EQUAL)};LABKEY.Query.Filter.LessThanOrEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DateLessThanOrEqual=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.DATE_LESS_THAN_OR_EQUAL)};LABKEY.Query.Filter.DateLessThanOrEqual.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.Contains=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.CONTAINS)};LABKEY.Query.Filter.Contains.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DoesNotContain=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.DOES_NOT_CONTAIN)};LABKEY.Query.Filter.DoesNotContain.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.StartsWith=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.STARTS_WITH)};LABKEY.Query.Filter.StartsWith.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.In=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.IN)};LABKEY.Query.Filter.In.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.EqualsOneOf=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.EQUALS_ONE_OF)};LABKEY.Query.Filter.EqualsOneOf.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.EqualsNoneOf=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.EQUALS_NONE_OF)};LABKEY.Query.Filter.EqualsNoneOf.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.NotIn=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.NOT_IN)};LABKEY.Query.Filter.NotIn.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.ContainsOneOf=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.CONTAINS_ONE_OF)};LABKEY.Query.Filter.ContainsOneOf.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.MemberOf=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.MEMBER_OF)};LABKEY.Query.Filter.ContainsOneOf.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.ContainsNoneOf=function(a,b){LABKEY.Query.Filter.call(this,a,b,LABKEY.Filter.Types.CONTAINS_NONE_OF)};LABKEY.Query.Filter.ContainsNoneOf.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.HasMissingValue=function(a){LABKEY.Query.Filter.call(this,a,null,LABKEY.Filter.Types.HAS_MISSING_VALUE)};LABKEY.Query.Filter.HasMissingValue.prototype=new LABKEY.Query.Filter;LABKEY.Query.Filter.DoesNotHaveMissingValue=function(a){LABKEY.Query.Filter.call(this,a,null,LABKEY.Filter.Types.DOES_NOT_HAVE_MISSING_VALUE)};LABKEY.Query.Filter.DoesNotHaveMissingValue.prototype=new LABKEY.Query.Filter;(function(){LABKEY.Query.Row=function(row){this.links=null;if(row.links){this.links=row.links}for(var attr in row.data){if(row.data.hasOwnProperty(attr)){this[attr]=row.data[attr]}}};LABKEY.Query.Row.prototype.get=function(columnName){columnName=columnName.toLowerCase();for(var attr in this){if(attr.toLowerCase()===columnName&&this.hasOwnProperty(attr)&&!(this[attr] instanceof Function)){return this[attr]}}return null};LABKEY.Query.Row.prototype.getValue=function(columnName){columnName=columnName.toLowerCase();for(var attr in this){if(attr.toLowerCase()===columnName&&this.hasOwnProperty(attr)&&!(this[attr] instanceof Function)){if(LABKEY.Utils.isArray(this[attr])){return this[attr].map(function(i){return i.value})}if(this[attr].hasOwnProperty("value")){return this[attr].value}}}return null};LABKEY.Query.Row.prototype.getLinks=function(){return this.links};LABKEY.Query.Row.prototype.getLink=function(linkType){if(this.links[linkType]){return this.links[linkType]}return null};var generateColumnModel=function(fields){var i,columns=[];for(i=0;i<fields.length;i++){columns.push({scale:fields[i].scale,hidden:fields[i].hidden,sortable:fields[i].sortable,align:fields[i].align,width:fields[i].width,dataIndex:fields[i].fieldKey.toString(),required:fields[i].nullable,editable:fields[i].userEditable,header:fields[i].shortCaption})}return columns};var generateGetDisplayField=function(fieldKeyToFind,fields){return function(){var fieldString=fieldKeyToFind.toString();for(var i=0;i<fields.length;i++){if(fieldString==fields[i].fieldKey.toString()){return fields[i]}}return null}};LABKEY.Query.Response=function(response){var i,attr;for(attr in response){if(response.hasOwnProperty(attr)){this[attr]=response[attr]}}this.schemaKey=LABKEY.SchemaKey.fromParts(response.schemaName);for(i=0;i<response.metaData.fields.length;i++){var field=response.metaData.fields[i],lookup=field.lookup;field.fieldKey=LABKEY.FieldKey.fromParts(field.fieldKey);if(lookup&&lookup.schemaName){lookup.schemaName=LABKEY.SchemaKey.fromParts(lookup.schemaName)}if(field.displayField){field.displayField=LABKEY.FieldKey.fromParts(field.displayField);field.getDisplayField=generateGetDisplayField(field.displayField,response.metaData.fields)}if(field.extFormatFn){var ext4Index=field.extFormatFn.indexOf("Ext4."),isExt4Fn=ext4Index==0||ext4Index==1,canEvalExt3=!isExt4Fn&&window&&window.Ext!==undefined,canEvalExt4=isExt4Fn&&window&&window.Ext4!==undefined;if(canEvalExt3||canEvalExt4){field.extFormatFn=eval(field.extFormatFn)}}}this.columnModel=generateColumnModel(this.metaData.fields);if(this.rows!==undefined){for(i=0;i<this.rows.length;i++){this.rows[i]=new LABKEY.Query.Row(this.rows[i])}}else{this.rows=[]}return this};LABKEY.Query.Response.prototype.getMetaData=function(){return this.metaData};LABKEY.Query.Response.prototype.getSchemaName=function(asString){return asString?this.schemaKey.toString():this.schemaName};LABKEY.Query.Response.prototype.getQueryName=function(){return this.queryName};LABKEY.Query.Response.prototype.getColumnModel=function(){return this.columnModel};LABKEY.Query.Response.prototype.getRows=function(){return this.rows};LABKEY.Query.Response.prototype.getRow=function(idx){if(this.rows[idx]!==undefined){return this.rows[idx]}throw new Error("No row found for index "+idx)};LABKEY.Query.Response.prototype.getRowCount=function(){return this.rowCount}})();(function(){var b=function(i){var j={};if(i instanceof LABKEY.Query.Filter||i.getColumnName){j.fieldKey=LABKEY.FieldKey.fromString(i.getColumnName()).getParts();j.value=i.getValue();j.type=i.getFilterType().getURLSuffix();return j}if(i.fieldKey){i.fieldKey=e(i.fieldKey)}else{throw new Error('All filters must have a "fieldKey" attribute.')}if(!i.fieldKey){throw new Error("Filter fieldKeys must be valid FieldKeys")}if(!i.type){throw new Error('All filters must have a "type" attribute.')}return i};var a=function(j,i){if(j instanceof i){return j.getParts()}if(j instanceof Array){return j}if(typeof j==="string"){return i.fromString(j).getParts()}return false};var h=function(i){return a(i,LABKEY.SchemaKey)};var e=function(i){return a(i,LABKEY.FieldKey)};var d=function(i){if(!i||i==null){throw new Error("A source is required for a GetData request.")}if(!i.type){i.type="query"}if(!i.schemaName){throw new Error("A schemaName is required.")}i.schemaName=h(i.schemaName);if(!i.schemaName){throw new Error("schemaName must be a FieldKey")}if(i.type==="query"){if(!i.queryName||i.queryName==null){throw new Error('A queryName is required for getData requests with type = "query"')}}else{if(i.type==="sql"){if(!i.sql){throw new Error('sql is required if source.type = "sql"')}}else{throw new Error("Unsupported source type.")}}};var g=function(j){if(!j.columns||j.columns==null){throw new Error("pivot.columns is required.")}if(!j.columns instanceof Array){throw new Error("pivot.columns must be an array of fieldKeys.")}for(var k=0;k<j.columns.length;k++){j.columns[k]=e(j.columns[k]);if(!j.columns[k]){throw new Error("pivot.columns must be an array of fieldKeys.")}}if(!j.by||j.by==null){throw new Error("pivot.by is required")}j.by=e(j.by);if(!j.by===false){throw new Error("pivot.by must be a fieldKey.")}};var f=function(j){var k;if(!j.type||j.type!=="aggregate"){j.type="aggregate"}if(j.groupBy&&j.groupBy!=null){if(!j.groupBy instanceof Array){throw new Error("groupBy must be an array.")}}if(j.aggregates&&j.aggregates!=null){if(!j.aggregates instanceof Array){throw new Error("aggregates must be an array.")}for(k=0;k<j.aggregates.length;k++){if(!j.aggregates[k].fieldKey){throw new Error("All aggregates must include a fieldKey.")}j.aggregates[k].fieldKey=e(j.aggregates[k].fieldKey);if(!j.aggregates[k].fieldKey){throw new Error("Aggregate fieldKeys must be valid fieldKeys")}if(!j.aggregates[k].type){throw new Error("All aggregates must include a type.")}}}if(j.filters&&j.filters!=null){if(!j.filters instanceof Array){throw new Error("The filters of a transform must be an array.")}for(k=0;k<j.filters.length;k++){j.filters[k]=b(j.filters[k])}}};var c=function(j){if(!j||j===null||j===undefined){throw new Error("A config object is required for GetData requests.")}var l={renderer:{}};var k;d(j.source);l.source={type:j.source.type,schemaName:j.source.schemaName};if(j.source.type==="query"){l.source.queryName=j.source.queryName}if(j.source.type==="sql"){l.source.sql=j.source.sql}if(j.transforms){if(!(j.transforms instanceof Array)){throw new Error("transforms must be an array.")}l.transforms=j.transforms;for(k=0;k<l.transforms.length;k++){f(l.transforms[k])}}if(j.pivot){g(j.pivot)}if(j.columns){if(!(j.columns instanceof Array)){throw new Error("columns must be an array of FieldKeys.")}for(k=0;k<j.columns.length;k++){j.columns[k]=e(j.columns[k]);if(!j.columns[k]){throw new Error("columns must be an array of FieldKeys.")}}l.renderer.columns=j.columns}if(j.hasOwnProperty("offset")){l.renderer.offset=j.offset}if(j.hasOwnProperty("includeDetailsColumn")){l.renderer.includeDetailsColumn=j.includeDetailsColumn}if(j.hasOwnProperty("maxRows")){l.renderer.maxRows=j.maxRows}if(j.sort){if(!(j.sort instanceof Array)){throw new Error("sort must be an array.")}for(k=0;k<j.sort.length;k++){if(!j.sort[k].fieldKey){throw new Error("Each sort must specify a field key.")}j.sort[k].fieldKey=e(j.sort[k].fieldKey);if(!j.sort[k].fieldKey){throw new Error("Invalid field key specified for sort.")}if(j.sort[k].dir){j.sort[k].dir=j.sort[k].dir.toUpperCase()}}l.renderer.sort=j.sort}return l};LABKEY.Query.GetData={getRawData:function(j){var k=c(j);k.renderer.type="json";var i={method:"POST",url:LABKEY.ActionURL.buildURL("query","getData",j.source.containerPath),jsonData:k};if(!j.failure){i.failure=function(l,m){if(l.status!=0){var n=LABKEY.Utils.decode(l.responseText);console.error("Failure occurred during getData",n)}}}else{i.failure=function(l,m){var n=LABKEY.Utils.decode(l.responseText);j.failure(n)}}if(!j.success){throw new Error("A success callback is required.")}if(!j.scope){j.scope=this}i.success=function(l,m){var n=LABKEY.Utils.decode(l.responseText);var o=new LABKEY.Query.Response(n);j.success.call(j.scope,o,l,m)};return new LABKEY.Ajax.request(i)}}})();LABKEY.Report=new function(){function b(d,e){return LABKEY.Utils.getCallbackWrapper(function(i,g,h){if(i&&i.outputParams){for(var f=0;f<i.outputParams.length;f++){var j=i.outputParams[f];if(j.type=="json"){j.value=LABKEY.Utils.decode(j.value)}}}if(d){d.call(e||this,i,h,g)}},this)}function a(d,g){var f={};if(g){if(d.reportId){f.reportId=d.reportId}if(d.reportName){f.reportName=d.reportName}if(d.schemaName){f.schemaName=d.schemaName}if(d.queryName){f.queryName=d.queryName}}else{if(d.functionName){f.functionName=d.functionName}}if(d.reportSessionId){f.reportSessionId=d.reportSessionId}for(var e in d.inputParams){f["inputParams["+e+"]"]=d.inputParams[e]}return f}function c(d,e){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","execute",d.containerPath),method:"POST",success:b(LABKEY.Utils.getOnSuccess(d),d.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true),jsonData:a(d,e)})}return{createSession:function(e){var d=e&&e.containerPath;var f={};f.clientContext=e.clientContext;LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","createSession",d),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(e),e.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(e),e.scope,true),jsonData:f})},deleteSession:function(d){var e={reportSessionId:d.reportSessionId};LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","deleteSession",d.containerPath),method:"POST",params:e,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(d),d.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true)})},getSessions:function(d){LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("reports","getSessions",d.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(d),d.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true)})},execute:function(d){if(!d){throw"You must supply a config object to call this method."}if(!d.reportId&&!d.reportName){throw"You must supply a value for the reportId or reportName config property."}return c(d,true)},executeFunction:function(d){if(!d){throw"You must supply a config object to call this method."}if(!d.functionName){throw"You must supply a value for the functionName config property."}return c(d,false)}}};LABKEY.Security=new function(){return{permissions:{read:1,insert:2,update:4,del:8,readOwn:16,updateOwn:64,deleteOwn:128,admin:32768,all:65535},effectivePermissions:{insert:"org.labkey.api.security.permissions.InsertPermission",read:"org.labkey.api.security.permissions.ReadPermission",admin:"org.labkey.api.security.permissions.AdminPermission",del:"org.labkey.api.security.permissions.DeletePermission",readOwn:"org.labkey.api.security.permissions.ReadSomePermission",update:"org.labkey.api.security.permissions.UpdatePermission"},roles:{admin:65535,editor:15,author:195,reader:1,restrictedReader:16,submitter:2,noPerms:0},systemGroups:{administrators:-1,users:-2,guests:-3,developers:-4},getGroupPermissions:function(a){var b={};if(a.includeSubfolders!=undefined){b.includeSubfolders=a.includeSubfolders}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getGroupPerms",a.containerPath),method:"GET",params:b,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},hasPermission:function(a,b){return a&b},hasEffectivePermission:function(c,a){for(var b=0;b<c.length;b++){if(c[b]==a){return true}}return false},getRole:function(a){for(var b in LABKEY.Security.roles){if(LABKEY.Security.roles.hasOwnProperty(b)){if(a==LABKEY.Security.roles[b]){return b}}}},getUserPermissions:function(a){var b={};if(a.userId!=undefined){b.userId=a.userId}else{if(a.userEmail!=undefined){b.userEmail=a.userEmail}}if(a.includeSubfolders!=undefined){b.includeSubfolders=a.includeSubfolders}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getUserPerms",a.containerPath),method:"GET",params:b,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},getUsers:function(a){var b={};if(undefined!=a.groupId){b.groupId=a.groupId}else{if(undefined!=a.group){b.group=a.group}}if(undefined!=a.name){b.name=a.name}if(undefined!=a.allMembers){b.allMembers=a.allMembers}if(undefined!=a.active){b.active=a.active}if(undefined!=a.permissions){if(!LABKEY.Utils.isArray(a.permissions)){a.permissions=[a.permissions]}b.permissions=a.permissions}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("user","getUsers.api",a.containerPath),method:"GET",params:b,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},createContainer:function(a){var b={};b.name=a.name;b.title=a.title;b.description=a.description;b.isWorkbook=a.isWorkbook;b.folderType=a.folderType;return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("core","createContainer",a.containerPath),method:"POST",jsonData:b,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},deleteContainer:function(a){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("core","deleteContainer",a.containerPath),method:"POST",jsonData:{},success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},moveContainer:function(a){var b={};b.container=a.container||a.containerPath;b.parent=a.destinationParent||a.parent||a.parentPath;b.addAlias=true;if(!b.container){console.error("'containerPath' must be specified for LABKEY.Security.moveContainer invocation.");return}if(!b.parent){console.error("'parent' must be specified for LABKEY.Security.moveContainer invocation.");return}if(a.addAlias===false){b.addAlias=false}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("core","moveContainer",b.container),method:"POST",jsonData:b,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},getFolderTypes:function(a){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("core","getFolderTypes",a.containerPath),method:"POST",jsonData:{},success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},getModules:function(a){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("admin","getModules",a.containerPath),method:"POST",jsonData:{},success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},getContainers:function(a){var b={};a=a||{};if(undefined!=a.container){if(LABKEY.Utils.isArray(a.container)){b.multipleContainers=true}else{a.container=[a.container]}b.container=a.container}if(undefined!=a.includeSubfolders){b.includeSubfolders=a.includeSubfolders}if(undefined!=a.depth){b.depth=a.depth}if(undefined!=a.moduleProperties){b.moduleProperties=a.moduleProperties}if(undefined!=a.includeEffectivePermissions){b.includeEffectivePermissions=a.includeEffectivePermissions}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("project","getContainers",a.containerPath),method:"GET",params:b,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},currentUser:LABKEY.user,currentContainer:LABKEY.container,getGroupsForCurrentUser:function(a){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getGroupsForCurrentUser",a.containerPath),method:"GET",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},ensureLogin:function(a){if(LABKEY.Security.currentUser.isGuest||a.force){if(a.useSiteLoginPage){window.location=LABKEY.ActionURL.buildURL("login","login")+"?returnUrl="+window.location}else{return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","ensureLogin"),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(c,b){if(c.currentUser){LABKEY.Security.currentUser=c.currentUser}if(LABKEY.Utils.getOnSuccess(a)){LABKEY.Utils.getOnSuccess(a).call(a.scope||this,c,b)}},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})}}else{LABKEY.Utils.getOnSuccess(a).call(a.scope||this,{currentUser:LABKEY.Security.currentUser})}},getSecurableResources:function(a){var b={};if(undefined!=a.includeSubfolders){b.includeSubfolders=a.includeSubfolders}if(undefined!=a.includeEffectivePermissions){b.includeEffectivePermissions=a.includeEffectivePermissions}return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getSecurableResources",a.containerPath),method:"GET",params:b,success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},getSchemaPermissions:function(b){if(b.schemaName&&b.schemaName!="study"){throw"Method only works for the study schema"}var a=function(k,f){var n=null;for(var h=0;h<k.resources.children.length;h++){var l=k.resources.children[h];if(l.resourceClass=="org.labkey.study.model.StudyImpl"){n=l;break}}if(null==n){b.failure.apply(b.scope||this,[{description:"No study found in container."},f]);return}var c={queries:{}},m;for(h=0;h<n.children.length;h++){m=n.children[h];c.queries[m.name]=m;m.permissionMap={};for(var g=0;g<m.effectivePermissions.length;g++){m.permissionMap[m.effectivePermissions[g]]=true}}b.success.apply(b.scope||this,[{schemas:{study:c}},f])};var d={};if(b){for(var e in b){if(b.hasOwnProperty(e)){d[e]=b[e]}}}d.includeEffectivePermissions=true;d.success=a;return LABKEY.Security.getSecurableResources(d)},getRoles:function(a){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getRoles"),method:"GET",success:LABKEY.Utils.getCallbackWrapper(function(g,e){var b;var d={};var c;for(b=0;b<g.permissions.length;++b){c=g.permissions[b];d[c.uniqueName]=c}var f;var h;for(b=0;b<g.roles.length;++b){h=g.roles[b];for(f=0;f<h.permissions.length;++f){h.permissions[f]=d[h.permissions[f]]}}LABKEY.Utils.getOnSuccess(a).call(a.scope||this,g.roles,e)},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},getPolicy:function(a){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","getPolicy",a.containerPath),method:"GET",params:{resourceId:a.resourceId},success:LABKEY.Utils.getCallbackWrapper(function(c,b){c.policy.requestedResourceId=a.resourceId;var d=new LABKEY.SecurityPolicy(c.policy);LABKEY.Utils.getOnSuccess(a).call(a.scope||this,d,c.relevantRoles,b)},this),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})},deletePolicy:function(a){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","deletePolicy",a.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true),jsonData:{resourceId:a.resourceId},headers:{"Content-Type":"application/json"}})},savePolicy:function(a){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","savePolicy",a.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true),jsonData:a.policy.policy,headers:{"Content-Type":"application/json"}})},createGroup:function(a){var b={name:a.groupName};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","createGroup",a.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true),jsonData:b,headers:{"Content-Type":"application/json"}})},deleteGroup:function(a){var b={id:a.groupId};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","deleteGroup",a.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true),jsonData:b,headers:{"Content-Type":"application/json"}})},renameGroup:function(a){return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","renameGroup",a.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true),jsonData:{id:a.groupId,newName:a.newName},headers:{"Content-Type":"application/json"}})},addGroupMembers:function(a){var b={groupId:a.groupId,principalIds:(LABKEY.Utils.isArray(a.principalIds)?a.principalIds:[a.principalIds])};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","addGroupMember",a.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true),jsonData:b,headers:{"Content-Type":"application/json"}})},removeGroupMembers:function(a){var b={groupId:a.groupId,principalIds:(LABKEY.Utils.isArray(a.principalIds)?a.principalIds:[a.principalIds])};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","removeGroupMember",a.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true),jsonData:b,headers:{"Content-Type":"application/json"}})},createNewUser:function(a){var b={email:a.email,sendEmail:a.sendEmail};return LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("security","createNewUser",a.containerPath),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true),jsonData:b,headers:{"Content-Type":"application/json"}})},getHomeContainer:function(){return LABKEY.homeContainer},getSharedContainer:function(){return LABKEY.sharedContainer}}};LABKEY.Query.Visualization=new function(){function c(d){var e={};if(d.filters&&d.filters.length){e.filters=d.filters}if(d.dateMeasures!==undefined){e.dateMeasures=d.dateMeasures}if(d.allColumns!==undefined){e.allColumns=d.allColumns}if(d.showHidden!==undefined){e.showHidden=d.showHidden}return e}function a(d,e){return function(i,f,g){var h=null;if(i&&i.getResponseHeader&&i.getResponseHeader("Content-Type")&&i.getResponseHeader("Content-Type").indexOf("application/json")>=0){h=LABKEY.Utils.decode(i.responseText);if(h.visualizationConfig){h.visualizationConfig=LABKEY.Utils.decode(h.visualizationConfig)}}if(d){d.call(e||this,h,f,g)}}}function b(f,e,d){return function(g,h){var i=null;var j=null;if(g&&g.getResponseHeader&&g.getResponseHeader("Content-Type")&&g.getResponseHeader("Content-Type").indexOf("application/json")>=0){i=LABKEY.Utils.decode(g.responseText);j=f(i)}if(e){e.call(d||this,j,g)}}}return{getTypes:function(d){function e(f){if(f.types&&f.types.length){return f.types}return[]}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getVisualizationTypes"),method:"GET",success:b(e,LABKEY.Utils.getOnSuccess(d),d.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true)})},getMeasures:function(d){function e(h){var j=[];if(h.measures&&h.measures.length){for(var g=0;g<h.measures.length;g++){j.push(new LABKEY.Query.Visualization.Measure(h.measures[g]))}}return j}var f=c(d);LABKEY.Ajax.request({url:d.endpoint||LABKEY.ActionURL.buildURL("visualization","getMeasures"),method:"GET",success:b(e,LABKEY.Utils.getOnSuccess(d),d.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true),params:f})},getData:function(i){var l={measures:[],sorts:i.sorts,filterQuery:i.filterQuery,filterUrl:i.filterUrl,limit:i.limit,groupBys:i.groupBys,metaDataOnly:i.metaDataOnly,joinToFirst:i.joinToFirst===true};var d,g,j,o,h,k;for(j=0;j<i.measures.length;j++){var p=i.measures[j];d={measure:p.measure,time:p.time};if(p.dimension){d.dimension=p.dimension}if(p.dateOptions){d.dateOptions=p.dateOptions}if(p.filterArray){d.filterArray=p.filterArray;g=[];for(o=0;o<d.filterArray.length;o++){k=d.filterArray[o];if(k&&k.getURLParameterName){h=encodeURIComponent(k.getURLParameterName())+"="+encodeURIComponent(k.getURLParameterValue());g.push(h)}}d.filterArray=g}l.measures.push(d)}var e={};if(i.parameters){for(var n in i.parameters){if(i.parameters.hasOwnProperty(n)){e["visualization.param."+n]=i.parameters[n]}}}var q=i.endpoint||LABKEY.ActionURL.buildURL("visualization","getData",i.containerPath);q+="?"+LABKEY.ActionURL.queryString(e);LABKEY.Ajax.request({url:q,method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(i),i.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(i),i.scope,true),jsonData:l,headers:{"Content-Type":"application/json"}})},save:function(d){var e={name:d.name,description:d.description,json:LABKEY.Utils.encode(d.visualizationConfig),replace:d.replace,shared:d.shared,thumbnailType:d.thumbnailType,iconType:d.iconType,svg:d.svg,type:d.type,schemaName:d.schemaName,queryName:d.queryName};LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","saveVisualization"),method:"POST",success:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnSuccess(d),d.scope,false),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(d),d.scope,true),jsonData:e,headers:{"Content-Type":"application/json"}})},get:function(e){var f={reportId:e.reportId,name:e.name,schemaName:e.schemaName,queryName:e.queryName};var d=LABKEY.Utils.getOnSuccess(e);d=a(d,e.scope);LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getVisualization"),method:"POST",initialConfig:e,success:d,failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(e),e.scope,true),jsonData:f,headers:{"Content-Type":"application/json"}})},getFromUrl:function(e){var g=e||{};g.success=LABKEY.Utils.getOnSuccess(e);g.failure=LABKEY.Utils.getOnFailure(e);var d=LABKEY.ActionURL.getParameters();var f=false;if(g.reportId){f=true}else{if(d.name){g.name=d.name;g.schemaName=d.schemaName;g.queryName=d.queryName;f=true}}if(f){LABKEY.Query.Visualization.get(g)}return f},getDataFilterFromURL:function(){var d=LABKEY.ActionURL.getParameters();return d.filterUrl}}};LABKEY.Visualization=LABKEY.Query.Visualization;LABKEY.Query.Visualization.Measure=function(a){LABKEY.Utils.apply(this,a)};LABKEY.Query.Visualization.Measure.prototype.getQueryName=function(){return this.queryName};LABKEY.Query.Visualization.Measure.prototype.getSchemaName=function(){return this.schemaName};LABKEY.Query.Visualization.Measure.prototype.isUserDefined=function(){return this.isUserDefined};LABKEY.Query.Visualization.Measure.prototype.getName=function(){return this.name};LABKEY.Query.Visualization.Measure.prototype.getLabel=function(){return this.label};LABKEY.Query.Visualization.Measure.prototype.getType=function(){return this.type};LABKEY.Query.Visualization.Measure.prototype.getDescription=function(){return this.description};LABKEY.Query.Visualization.Measure.prototype.getDimensions=function(a){var c={queryName:this.queryName,schemaName:this.schemaName};if(a.includeDemographics){c.includeDemographics=a.includeDemographics}function b(e){var f=[];if(e.dimensions&&e.dimensions.length){for(var d=0;d<e.dimensions.length;d++){f.push(new LABKEY.Query.Visualization.Dimension(e.dimensions[d]))}}return f}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getDimensions"),method:"GET",params:c,success:getSuccessCallbackWrapper(b,LABKEY.Utils.getOnSuccess(a),a.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(a),a.scope,true)})};LABKEY.Visualization.Measure=LABKEY.Query.Visualization.Measure;LABKEY.Query.Visualization.Dimension=function(a){LABKEY.Utils.apply(this,a)};LABKEY.Query.Visualization.Dimension.getQueryName=function(){return this.queryName};LABKEY.Query.Visualization.Dimension.getSchemaName=function(){return this.schemaName};LABKEY.Query.Visualization.Dimension.isUserDefined=function(){return this.isUserDefined};LABKEY.Query.Visualization.Dimension.getName=function(){return this.name};LABKEY.Query.Visualization.Dimension.getLabel=function(){return this.label};LABKEY.Query.Visualization.Dimension.getType=function(){return this.type};LABKEY.Query.Visualization.Dimension.getDescription=function(){return this.description};LABKEY.Query.Visualization.Dimension.getValues=function(b){var c={queryName:this.queryName,schemaName:this.schemaName,name:this.name};function a(d){if(d.success&&d.values){return d.values}return[]}LABKEY.Ajax.request({url:LABKEY.ActionURL.buildURL("visualization","getDimensionValues"),method:"GET",params:c,success:getSuccessCallbackWrapper(a,LABKEY.Utils.getOnSuccess(b),b.scope),failure:LABKEY.Utils.getCallbackWrapper(LABKEY.Utils.getOnFailure(b),b.scope,true)})};LABKEY.Visualization.Dimension=LABKEY.Query.Visualization.Dimension;LABKEY.Query.Visualization.Filter=new function(){function a(b){var c=[b.schemaName];if(b.queryName){c.push(b.queryName)}else{c.push("~")}if(b.queryType){c.push(b.queryType)}return c.join("|")}return{QueryType:{BUILT_IN:"builtIn",CUSTOM:"custom",DATASETS:"datasets",ALL:"all"},create:function(b){if(!b.schemaName){throw new Error("Coding Error!","You must supply a value for schemaName in your configuration object!")}else{return a(b)}}}};LABKEY.Visualization.Filter=LABKEY.Query.Visualization.Filter;LABKEY.Query.Visualization.Aggregate={SUM:"SUM",AVG:"AVG",COUNT:"COUNT",MIN:"MIN",MAX:"MAX"};LABKEY.Visualization.Aggregate=LABKEY.Query.Visualization.Aggregate;LABKEY.Query.Visualization.Interval={DAY:"DAY",WEEK:"WEEK",MONTH:"MONTH",YEAR:"YEAR"};LABKEY.Visualization.Interval=LABKEY.Query.Visualization.Interval;LABKEY.Query.Visualization.Type={TimeChart:"ReportService.TimeChartReport",GenericChart:"ReportService.GenericChartReport"};LABKEY.Visualization.Type=LABKEY.Query.Visualization.Type;